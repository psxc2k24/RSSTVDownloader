<File version="3.2">
  <FileID>27ffbb23-8302-43f8-b17f-0fee7f365c06</FileID>
  <LastExport>134116546607398083</LastExport>
  <Preview>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
D6JjFX71nmIfJyo4JNLaAlBntqKbw/RMKa2w2dqK0DQwq7ZRhyobOl5tABhdWlfT4Jzqpzc09iRY
65/8M80d+O/lfvCNfNmXtHLzd9r45X+qmeC/U+OcVN3caW2Kr2npsp7/zymuVEFth8rqWpRRUKmK
jgk1dPapuK5XrWMu1Ta3WVesdWhK2fklyiiqVmXXlOo7epWZV6qCuj41dvUrr6pNVU0dKjLPwzd2
qqpjxHopQ3Fthypa+pRfUqHssmZVt/Upu6DMOnxlc6cy80utr1e19Sq7sEoljZ0qrulQw+CC2oZn
VVBeo6ruKRVX1Fmb9+vbe5WeX6by1gEV17SrcWhWZXWdqusdVV5huTVUVHWNq7S6wdpfoaKx09rn
oaiqURkFFSpt7FZeWb1qe+fUMjSv5sE5IiL6gDJvqJNe3Kpq8xR115Rqu81iO664jEo9SC5WTEqJ
HiQVK7+2R3U9M9ZhzMeyxkFlmEW8tF31vdOqNsftmbE21cemlupxerkepZcrNq1Mpc3D1mBhjtvQ
N6vCmh6ll7Ypr7JLzYPz1gJvvp5f061HaaXKqepSUl6dknJrrC0G9b0z1mHMYTOKW60HtGZN6pxY
VlVj56sNAOOODbUML6h5dkMj6be0/ov/RK7f/+dynfg/5D7+v8r7xX+l9b/9p5qJ/FJNMxtqG1ny
N2o+LlrvINg+5vB/PrKkduvr/o+twwvWNNIx5lCrOdxz39s6/rOvmdMYdbzwPfPR/Lt96+vWcc3h
/vR1/+fm+w61jyxuno9DbZvn3dA1qIrWEXWOu9S+ebn9x928HNbhti6LuR7Pnbb53tZ1NV8bc6mp
Z8R6SWSbdZ0WiIjoA6tz3KGMknaVNgyopn1C1e1jqukYV2PvrBr7/DX1zamua0rVbWPW92s7J1RQ
1aWcyi5llrSp2jxQbh+3vm++12iect48rsl8beu4dV2Tyi5rV151jzJLWlVnvmf2OWsbtb7X1O8/
r4aeGesybJ3u1vmmFjRZw4BZx7qnPKpu6nq1AWDSpc0Fz6n2gRl1dg2ps3NAHS3t6jR19Flf6+if
VNuoU20jZpH8ueRftNvHzOU2i3zg9183Mwg41THmekOn96baHMqIbFIrvbuGP/zMA0DziD6rvEvZ
FabuH6/cLP49ahlcUFX7hLLKOpUTeJgfKKu8UwW1/db9eUnjkHXcwMP4L8f2Mss6Vdo0bF3mjlGH
+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
e9jMzi9Zf/b+tQeAoYV1xWcU6aPf/Eb79u3Tnj17iIiI6GfSl1/vsQaAwfn11xsARp3StXvx+v67
b5WWlqa4uDgiIiL6GRQfF6dP//iVmvpnX38AGHFIN2KSdOjgAaWmpm47cSIiIno/MwPAl7u+UfPA
HAMAERGRXWIAICIismEMAERERDaMAYCIiMiGMQAQERHZMAYAIiIiG8YAQEREZMMYAIiIiGwYAwAR
EZENYwAgIiKyYQwARERENowBgIiIyIYxABAREdkwBgAiIiIbxgBARERkwxgAiIiIbBgDABERkQ1j
ACAiIrJhDABEREQ2jAGAiIjIhjEAEBER2TAGACIiIhvGAEBERGTDGACIiIhsGAMAERGRDWMAICIi
smEMAERERDaMAYCIiMiGMQAQERHZMAYAIiIiG8YAQEREZMMYAIiIiGwYAwAREZENYwAgIiKyYQwA
RERENowBgIiIyIYxABAREdkwBgAiIiIbxgBARERkwxgAiIiIbBgDABERkQ1jACAiIrJhDABEREQ2
jAGAiIjIhjEAEBER2TAGACIiIhvGAEBERGTDGACIiIhsGAMAERGRDWMAICIismEMAERERDaMAYCI
iMiGMQAQERHZMAYAIiIiG8YAQEREZMMYAIiIiGwYAwAREZENYwAgIiKyYQwARERENowBgIiIyIYx
ABAREdkwBgAiIiIbxgBARERkwxgAiIiIbBgDABERkQ1jACAiIrJhDABEREQ2jAGAiIjIhjEAEBER
2TAGACIiIhvGAEBERGTDGACIiIhsGAMAERGRDWMAICIismEMAERERDaMAYCIiMiGMQAQERHZMAYA
IiIiG8YAQEREZMMYAIiIiGwYAwAREZENYwAgIiKyYQwARERENowBgIiIyIYxABAREdkwBgAiIiIb
xgBARERkwxgAiIiIbBgDABERkQ1jACAiIrJhDABEREQ2jAGAiIjIhjEAEBER2TAGACIiIhvGAEBE
RGTDGACIiIhsGAMAERGRDWMAICIismEMAERERDaMAYCIiMiGMQAQERHZMAYAIiIiG8YAQEREZMMY
AIiIiGwYAwAREZENYwAgIiKyYQwARERENowBgIiIyIYxABAREdkwBgAiIiIbxgBARERkwxgAiIiI
bBgDABERkQ1jACAiIrJhDABEREQ2jAGAiIjIhjEAEBER2TAGACIiIhvGAEBERGTDGACIiIhsGAMA
ERGRDWMAICIismEMAERERDaMAYCIiMiGMQAQERHZMAYAIiIiG8YAQEREZMMYAIiIiGwYAwAREZEN
YwAgIiKyYQwARERENowBgIiIyIYxABAREdkwBgAiIiIbxgBARERkwxgAiIiIbBgDABERkQ1jACAi
IrJhDABEREQ2jAGAiIjIhjEAEBER2TAGACIiIhvGAEBERGTDGACIiIhsGAMAERGRDWMAICIismEM
AERERDaMAYCIiMiGMQAQERHZMAYAIiIiG8YAQEREZMMYAIiIiGwYAwAREZENYwAgIiKyYQwARERE
NowBgIiIyIYxABAREdkwBgAiIiIbxgBARERkwxgAiIiIbBgDABERkQ1jACAiIrJhDABEREQ2jAGA
iIjIhjEAEBER2TAGACIiIhvGAEBERGTDGACIiIhs2F88AETef6LDhw4qOztbSUlJRERE9DMoOSlJ
f/xqt5r6Z19/ABhe2lBMUo5++Xd/p71792rXrl1ERET0M2j3rl363SefqXPM+foDQPuoS30TDo2M
DKuvr0/9/f1ERET0M2hgoF8jY5PqHHepf3b19QeAgSmX3O5lLS9vz+12v5MCLwcRERG9mFm7F5Zc
6hhz/rQBoH/SKYdjSUtLL+ZwODQ3N6fp6ekdb3Fx0Tr/wMtERERE/szaPTu/9GYHALP4zs7OamJi
QvPz8zuaOd/x8XFrCAi8skREROTvrQ0AY2NjWl1d1btgBoGpqSm2AhAREf1Ab2UAMJlH4Wtra3r6
9OmLbWxo46lbOQmxunv3jrLKOv60cruXVJBXLPfG88v5Fo/aO/o3P9/YfrqbGWbhZwAgIiL64XZ8
ADBr+9rSgC6evarO7haFnb+h0dkZ9QwOqCwlRoePXlPXwLCGR0bU29clx+qGZkYH1NvWoMuXrqiw
ulkO7/aF//kBwJw/AwAREdEP904GgHX3qE58d0CXg88o4mas7l46qt989ol+9evPdDH4qkIvhOr8
0e/1m09+o6DgKJ09tFfHj4Xq1ImLCr0QrEdp9f7tAAwAREREP6l3MgCsLvTpamS8vI45RV8J0+4/
fKXIG7d0KfiKEpPTlJaZr8cR53XybKgePHys2OsR+m7Pbp24mq6poRbdjs5hACAiIvoL2vEBwOwD
sO5ZUHNzt7VYj3R1qrW+TI8SklTb1q2e7m519Y1qeX5Yjx9Gq2FgQvWZaUpIzVBj25AW5ibU1jms
jY2X7wfAAEBERPTjvbUBwLwKwAwA78LCwgIDABER0Z/prQwAZuGdmZnRyMiI9V4AO5nZ8jA6Osr7
ABAREf2Z3soA4D9h/xBgtgSYRXknM1sAePRPRET0w721AcB/4g45nc4dL/ByEBER0Yu91QGAiIiI
3s/e2gCwuLgk17Jbyy6nHE6X9XFpcfvhiN6PFuVwLmt1bU3uZeeO7ENizsPl9lg7y676VuR4yWG2
5XBoedm1/euvmDlPp8ttnefaqk8u55IWX3I4K4fzLzqvN5p1uZety23uS8z9y7bDfABZt4ll/21i
bXVFTsfWz8f83Jdf7TZC9Iq9tQHAbIofG+zX+NS85mcmNDI+bd2AnU7HC08NmBu0w/qc5+zp3WUW
/6WZMeXnZKu9f2zztup/Osm6rTq2brfmduq//Zp/+2+7P+1pJ5fLpdG+duXmZCu3qEwzi8v+Qdn6
/tZ5bP5+mH1aHOb3ZV7Dw6Nacrrk+gnn63S5NDXSZ51ndn6FJuf9w/mfrp85TYd1uKX5GQ0Nj2lp
82tuj+fZ4rt1mbaO87L7gDeZWfwXJoesy909NPns57O1r8+f7lOe+9k8uz7bT+99zdwmJga7Nm8T
1ZpZMrcJl5xL8xoaGtHCkvPZz33r+j5/PZ/9LLb+PwKehn3+/2vrtstQYd/e2gCw/nRVyVeCtOvE
XTVW5Ssmsdi685pfNDe6Rc3Mzmp2bk7LHo+WFmY0ZyZcc+fykgtJ9HZzaHXVqSfXLys84obSsyrl
9Cxrdm7B2howMTauhaVluZyLmp6Zl9ezbL3ixOl2W4vk+OSMdce9/XT/XA6try3rcVSYwm4+VmFp
uSZmZq0/oT3c16X2nhEtLMxbWwjmZ6c0M79obZ0Y7SxX2JVYLbrdmp2b17J72Xp0vP30X97a2ory
4m7p4rWHun05VDHJ1VrxOTXvcMm97ND0zJy8Xo/1cWqoSVcjH2nR69PqikvFWWnKzC9Xd/+olhZn
NbOwJI/bofHxCS04XG9xIXHKt7Kgh+EhuhJ5W9n5dXIsL2lqZs76e+bmMGYxW1xc0Nz8giYmxjS3
5JJneUnTs3Ov/X/0Lltf8yr1/jWF345XZPAlJeQ0a8XnlnNuQFHXojW26NTc3Lzcbpemxsc0t+D0
/9ymZ62f2+zMlBxurzyuRY2OjWvJ5bIOPzc7o8npmRf+vxyLcxqfmJBr82tkv97aALC26lFhcowO
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
f/rGD3Avzmh083Abm6e/lWHOf0cGALNpc2hoNODiAe+W2UT7QwPA7Ox84MHfGLOQmTfveX4AGBoe
sR6Nvy0zM3Pq+4EBoLCgwHp6wNwRmztbs0+DueM1dwRrzhHdunJVtWW1unUhWDfuPtKDGzd0eM/X
+sOXX+jgkVO6Fx2n2uIKRRw5pt9+cUC9I4O68M3v9Yevdulo0FmlZyfpetRVHQ46p/DLd3ThxAF9
v/eozlyK0r079/QwPlnXoi4r8tYtxSc+0r3HMdr96SfKre5RzJULuhASrsa6GmtA2hoAOjq6rAXC
LCLmMm8tImZwMTqrsnTnbrzqikp08liw4uLidfn0ee39/GN9+vU+BZ28oPTMElXkZOub336m07fi
1d9QpE9+9Q/6fO8RnQ+JUHZuio6dPKOTZ0J141qUjhzYr+/3BCnqfoyibkQrMT1JZ86fU2LCQ0XH
PVL0/XD95uNvNeVc0XhbiS5fidLVG1FKSXms65HndOZqqpYWRnX8m306dy5M4SHham1pU29Xz7an
orYeOA2PjAX+KD8Y5qkU8/tnnncfHh5+NrxZ73po3g1zdVWpqanWvh/m597bWqf4hEwNjIyovrZB
VYWpCj4XooTUPFWVligq/LJi4vJVV5ap82dPKLu0WqWZsboRn6kpx7KWxocUd+26rtyMVnJGljJz
K+X1OXXzwlHtPXxeeeUVqmvs0mhPvSKvXVFF96TG2iuUWVCljvYO1Vbm6Ur4BZW1dCkn7oEuhd9X
WWG57l+JUE5Vi/89bF6yyP+5zACwNcBuLcxzbaU6cSRM8Q+fqKSmR6OD3ZrzrEmri+oZGFRDebZS
81vkMvvxLM5raHREI+NTWvb6tDA+bC36Pp9HKQ9vKj7XHG5RvvXtA4B52pEBALbFAOAfAAry8607
AfNcu7kzNncQBQUFmplb1NryuO5ejVBBRr6uXoxQ69CUitMe6cg33+vy9Rt69DhWd2/dVVFGnsJO
hioi9LrSM7N17fRRRd6KVkz0XcU+vKvLl07pwKGTunj5nuKirunAt/t1Ify6rl2K1M07j3Xj9k3d
vhOlB49idOt+tI7s/04peaWKf5SipafSzNSktRg+vwWgtLTUesRkLrO57OYOLScnx7q+vfX5uhl1
X4Wp6QoOf6yZ+QlFnjur04cPW+8VcPfmDcXFpSovMV5nj4fq7t1YpSfG6eyRo7obn65bN6L0+OFt
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
LGW08ZYAAAAASUVORK5CYII=</Preview>
  <Form>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</Form>
  <Code><![CDATA[#region Control Theme Helper Function
<#
	.SYNOPSIS
		Applies a theme to the control and its children.
	
	.PARAMETER Control
		The control to theme. Usually the form itself.
	
	.PARAMETER Theme
		The color theme:
		Light
		Dark

	.PARAMETER CustomColor
		A hashtable that contains the color values.
		Keys:
		WindowColor
		ContainerColor
		BackColor
		ForeColor
		BorderColor
		SelectionForeColor
		SelectionBackColor
		MenuSelectionColor
	.EXAMPLE
		PS C:\> Set-ControlTheme -Control $form1 -Theme Dark
	
	.EXAMPLE
		PS C:\> Set-ControlTheme -Control $form1 -CustomColor @{ WindowColor = 'White'; ContainerBackColor = 'Gray'; BackColor... }
	.NOTES
		Created by SAPIEN Technologies, Inc.
#>
function Set-ControlTheme {
	[CmdletBinding()]
	param
	(
		[Parameter(Mandatory = $true)]
		[ValidateNotNull()]
		[System.ComponentModel.Component]$Control,
		[ValidateSet('Light', 'Dark')]
		[string]$Theme = 'Dark',
		[System.Collections.Hashtable]$CustomColor
	)
	
	$Font = [System.Drawing.Font]::New('Segoe UI', 9)
	
	#Initialize the colors
	if ($Theme -eq 'Dark') {
		$WindowColor = [System.Drawing.Color]::FromArgb(32, 32, 32)
		$ContainerColor = [System.Drawing.Color]::FromArgb(45, 45, 45)
		$BackColor = [System.Drawing.Color]::FromArgb(32, 32, 32)
		$ForeColor = [System.Drawing.Color]::White
		$BorderColor = [System.Drawing.Color]::DimGray
		$SelectionBackColor = [System.Drawing.SystemColors]::Highlight
		$SelectionForeColor = [System.Drawing.Color]::White
		$MenuSelectionColor = [System.Drawing.Color]::DimGray
	}
	else {
		$WindowColor = [System.Drawing.Color]::White
		$ContainerColor = [System.Drawing.Color]::WhiteSmoke
		$BackColor = [System.Drawing.Color]::Gainsboro
		$ForeColor = [System.Drawing.Color]::Black
		$BorderColor = [System.Drawing.Color]::DimGray
		$SelectionBackColor = [System.Drawing.SystemColors]::Highlight
		$SelectionForeColor = [System.Drawing.Color]::White
		$MenuSelectionColor = [System.Drawing.Color]::LightSteelBlue
	}
	
	if ($CustomColor) {
		#Check and Validate the custom colors:
		$Color = $CustomColor.WindowColor -as [System.Drawing.Color]
		if ($Color) { $WindowColor = $Color }
		$Color = $CustomColor.ContainerColor -as [System.Drawing.Color]
		if ($Color) { $ContainerColor = $Color }
		$Color = $CustomColor.BackColor -as [System.Drawing.Color]
		if ($Color) { $BackColor = $Color }
		$Color = $CustomColor.ForeColor -as [System.Drawing.Color]
		if ($Color) { $ForeColor = $Color }
		$Color = $CustomColor.BorderColor -as [System.Drawing.Color]
		if ($Color) { $BorderColor = $Color }
		$Color = $CustomColor.SelectionBackColor -as [System.Drawing.Color]
		if ($Color) { $SelectionBackColor = $Color }
		$Color = $CustomColor.SelectionForeColor -as [System.Drawing.Color]
		if ($Color) { $SelectionForeColor = $Color }
		$Color = $CustomColor.MenuSelectionColor -as [System.Drawing.Color]
		if ($Color) { $MenuSelectionColor = $Color }
	}
	
	#Define the custom renderer for the menus
	#region Add-Type definition
	try {
		[SAPIENTypes.SAPIENColorTable] | Out-Null
	}
	catch {
		if ($PSVersionTable.PSVersion.Major -ge 7) {
			$Assemblies = 'System.Windows.Forms', 'System.Drawing', 'System.Drawing.Primitives'
		}
		else {
			$Assemblies = 'System.Windows.Forms', 'System.Drawing'
		}
		Add-Type -ReferencedAssemblies $Assemblies -TypeDefinition "
using System;
using System.Windows.Forms;
using System.Drawing;
namespace SAPIENTypes
{
    public class SAPIENColorTable : ProfessionalColorTable
    {
        Color ContainerBackColor;
        Color BackColor;
        Color BorderColor;
		Color SelectBackColor;

        public SAPIENColorTable(Color containerColor, Color backColor, Color borderColor, Color selectBackColor)
        {
            ContainerBackColor = containerColor;
            BackColor = backColor;
            BorderColor = borderColor;
			SelectBackColor = selectBackColor;
        } 
		public override Color MenuStripGradientBegin { get { return ContainerBackColor; } }
        public override Color MenuStripGradientEnd { get { return ContainerBackColor; } }
        public override Color ToolStripBorder { get { return BorderColor; } }
        public override Color MenuItemBorder { get { return SelectBackColor; } }
        public override Color MenuItemSelected { get { return SelectBackColor; } }
        public override Color SeparatorDark { get { return BorderColor; } }
        public override Color ToolStripDropDownBackground { get { return BackColor; } }
        public override Color MenuBorder { get { return BorderColor; } }
        public override Color MenuItemSelectedGradientBegin { get { return SelectBackColor; } }
        public override Color MenuItemSelectedGradientEnd { get { return SelectBackColor; } }      
        public override Color MenuItemPressedGradientBegin { get { return ContainerBackColor; } }
        public override Color MenuItemPressedGradientEnd { get { return ContainerBackColor; } }
        public override Color MenuItemPressedGradientMiddle { get { return ContainerBackColor; } }
        public override Color ImageMarginGradientBegin { get { return BackColor; } }
        public override Color ImageMarginGradientEnd { get { return BackColor; } }
        public override Color ImageMarginGradientMiddle { get { return BackColor; } }
    }
}"
	}
	#endregion
	
	$colorTable = New-Object SAPIENTypes.SAPIENColorTable -ArgumentList $ContainerColor, $BackColor, $BorderColor, $MenuSelectionColor
	$render = New-Object System.Windows.Forms.ToolStripProfessionalRenderer -ArgumentList $colorTable
	[System.Windows.Forms.ToolStripManager]::Renderer = $render
	
	#Set up our processing queue
	$Queue = New-Object System.Collections.Generic.Queue[System.ComponentModel.Component]
	$Queue.Enqueue($Control)
	
	Add-Type -AssemblyName System.Core
	
	#Only process the controls once.
	$Processed = New-Object System.Collections.Generic.HashSet[System.ComponentModel.Component]
	
	#Apply the colors to the controls
	while ($Queue.Count -gt 0) {
		$target = $Queue.Dequeue()
		
		#Skip controls we already processed
		if ($Processed.Contains($target)) { continue }
		$Processed.Add($target)
		
		#Set the text color
		$target.ForeColor = $ForeColor
		
		#region Handle Controls
		if ($target -is [System.Windows.Forms.Form]) {
			#Set Font
			$target.Font = $Font
			$target.BackColor = $ContainerColor
		}
		elseif ($target -is [System.Windows.Forms.SplitContainer]) {
			$target.BackColor = $BorderColor
		}
		elseif ($target -is [System.Windows.Forms.PropertyGrid]) {
			$target.BackColor = $BorderColor
			$target.ViewBackColor = $BackColor
			$target.ViewForeColor = $ForeColor
			$target.ViewBorderColor = $BorderColor
			$target.CategoryForeColor = $ForeColor
			$target.CategorySplitterColor = $ContainerColor
			$target.HelpBackColor = $BackColor
			$target.HelpForeColor = $ForeColor
			$target.HelpBorderColor = $BorderColor
			$target.CommandsBackColor = $BackColor
			$target.CommandsBorderColor = $BorderColor
			$target.CommandsForeColor = $ForeColor
			$target.LineColor = $ContainerColor
		}
		elseif ($target -is [System.Windows.Forms.ContainerControl] -or
			$target -is [System.Windows.Forms.Panel]) {
			#Set the BackColor for the container
			$target.BackColor = $ContainerColor
			
		}
		elseif ($target -is [System.Windows.Forms.GroupBox]) {
			$target.FlatStyle = 'Flat'
		}
		elseif ($target -is [System.Windows.Forms.Button]) {
			$target.FlatStyle = 'Flat'
			$target.FlatAppearance.BorderColor = $BorderColor
			$target.BackColor = $BackColor
		}
		elseif ($target -is [System.Windows.Forms.CheckBox] -or
			$target -is [System.Windows.Forms.RadioButton] -or
			$target -is [System.Windows.Forms.Label]) {
			#$target.FlatStyle = 'Flat'
		}
		elseif ($target -is [System.Windows.Forms.ComboBox]) {
			$target.BackColor = $BackColor
			$target.FlatStyle = 'Flat'
		}
		elseif ($target -is [System.Windows.Forms.TextBox]) {
			$target.BorderStyle = 'FixedSingle'
			$target.BackColor = $BackColor
		}
		elseif ($target -is [System.Windows.Forms.DataGridView]) {
			$target.GridColor = $BorderColor
			$target.BackgroundColor = $ContainerColor
			$target.DefaultCellStyle.BackColor = $WindowColor
			$target.DefaultCellStyle.SelectionBackColor = $SelectionBackColor
			$target.DefaultCellStyle.SelectionForeColor = $SelectionForeColor
			$target.ColumnHeadersDefaultCellStyle.BackColor = $ContainerColor
			$target.ColumnHeadersDefaultCellStyle.ForeColor = $ForeColor
			$target.EnableHeadersVisualStyles = $false
			$target.ColumnHeadersBorderStyle = 'Single'
			$target.RowHeadersBorderStyle = 'Single'
			$target.RowHeadersDefaultCellStyle.BackColor = $ContainerColor
			$target.RowHeadersDefaultCellStyle.ForeColor = $ForeColor
			
		}
		elseif ($PSVersionTable.PSVersion.Major -le 5 -and $target -is [System.Windows.Forms.DataGrid]) {
			$target.CaptionBackColor = $WindowColor
			$target.CaptionForeColor = $ForeColor
			$target.BackgroundColor = $ContainerColor
			$target.BackColor = $WindowColor
			$target.ForeColor = $ForeColor
			$target.HeaderBackColor = $ContainerColor
			$target.HeaderForeColor = $ForeColor
			$target.FlatMode = $true
			$target.BorderStyle = 'FixedSingle'
			$target.GridLineColor = $BorderColor
			$target.AlternatingBackColor = $ContainerColor
			$target.SelectionBackColor = $SelectionBackColor
			$target.SelectionForeColor = $SelectionForeColor
		}
		elseif ($target -is [System.Windows.Forms.ToolStrip]) {
			
			$target.BackColor = $BackColor
			$target.Renderer = $render
			
			foreach ($item in $target.Items) {
				$Queue.Enqueue($item)
			}
		}
		elseif ($target -is [System.Windows.Forms.ToolStripMenuItem] -or
			$target -is [System.Windows.Forms.ToolStripDropDown] -or
			$target -is [System.Windows.Forms.ToolStripDropDownItem]) {
			$target.BackColor = $BackColor
			foreach ($item in $target.DropDownItems) {
				$Queue.Enqueue($item)
			}
		}
		elseif ($target -is [System.Windows.Forms.ListBox] -or
			$target -is [System.Windows.Forms.ListView] -or
			$target -is [System.Windows.Forms.TreeView]) {
			$target.BackColor = $WindowColor
		}
		else {
			$target.BackColor = $BackColor
		}
		#endregion
		
		if ($target -is [System.Windows.Forms.Control]) {
			#Queue all the child controls
			foreach ($child in $target.Controls) {
				$Queue.Enqueue($child)
			}
			if ($target.ContextMenuStrip) {
				$Queue.Enqueue($target.ContextMenuStrip);
			}
		}
	}
}
#endregion

#region Control Helper Functions
function Show-NotifyIcon
{
<#
	.SYNOPSIS
		Displays a NotifyIcon's balloon tip message in the taskbar's notification area.
	
	.DESCRIPTION
		Displays a NotifyIcon's a balloon tip message in the taskbar's notification area.
		
	.PARAMETER NotifyIcon
     	The NotifyIcon control that will be displayed.
	
	.PARAMETER BalloonTipText
     	Sets the text to display in the balloon tip.
	
	.PARAMETER BalloonTipTitle
		Sets the Title to display in the balloon tip.
	
	.PARAMETER BalloonTipIcon	
		The icon to display in the ballon tip.
	
	.PARAMETER Timeout	
		The time the ToolTip Balloon will remain visible in milliseconds. 
		Default: 0 - Uses windows default.
#>
	 param(
	  [Parameter(Mandatory = $true, Position = 0)]
	  [ValidateNotNull()]
	  [System.Windows.Forms.NotifyIcon]$NotifyIcon,
	  [Parameter(Mandatory = $true, Position = 1)]
	  [ValidateNotNullOrEmpty()]
	  [String]$BalloonTipText,
	  [Parameter(Position = 2)]
	  [String]$BalloonTipTitle = '',
	  [Parameter(Position = 3)]
	  [System.Windows.Forms.ToolTipIcon]$BalloonTipIcon = 'None',
	  [Parameter(Position = 4)]
	  [int]$Timeout = 0
 	)
	
	if($null -eq $NotifyIcon.Icon)
	{
		#Set a Default Icon otherwise the balloon will not show
		$NotifyIcon.Icon = [System.Drawing.Icon]::ExtractAssociatedIcon([System.Windows.Forms.Application]::ExecutablePath)
	}
	
	$NotifyIcon.ShowBalloonTip($Timeout, $BalloonTipTitle, $BalloonTipText, $BalloonTipIcon)
}




function Update-ListBox {
<#
	.SYNOPSIS
		This functions helps you load items into a ListBox or CheckedListBox.
	
	.DESCRIPTION
		Use this function to dynamically load items into the ListBox control.
	
	.PARAMETER ListBox
		The ListBox control you want to add items to.
	
	.PARAMETER Items
		The object or objects you wish to load into the ListBox's Items collection.
	
	.PARAMETER DisplayMember
		Indicates the property to display for the items in this control.
	
	.PARAMETER Append
		Adds the item(s) to the ListBox without clearing the Items collection.
	
	.EXAMPLE
		Update-ListBox $ListBox1 "Red", "White", "Blue"
	
	.EXAMPLE
		Update-ListBox $listBox1 "Red" -Append
		Update-ListBox $listBox1 "White" -Append
		Update-ListBox $listBox1 "Blue" -Append
	
	.EXAMPLE
		Update-ListBox $listBox1 (Get-Process) "ProcessName"
	
	.NOTES
		Additional information about the function.
#>
	
	param
	(
		[Parameter(Mandatory = $true)]
		[ValidateNotNull()]
		[System.Windows.Forms.ListBox]$ListBox,
		[Parameter(Mandatory = $true)]
		[ValidateNotNull()]
		$Items,
		[Parameter(Mandatory = $false)]
		[string]$DisplayMember,
		[Parameter(Mandatory = $false)]
		[string]$ValueMember,
		[switch]$Append
	)
	
	if (-not $Append) {
		$listBox.Items.Clear()
	}
	
	if ($Items -is [System.Windows.Forms.ListBox+ObjectCollection]) {
		$listBox.Items.AddRange($Items)
	}
	elseif ($Items -is [Array]) {
		$listBox.BeginUpdate()
		foreach ($obj in $Items) {
			$listBox.Items.Add($obj)
		}
		$listBox.EndUpdate()
	}
	else {
		$listBox.Items.Add($Items)
	}
	
	if ($DisplayMember) {
		$listBox.DisplayMember = $DisplayMember
	}
	if ($ValueMember) {
		$ListBox.ValueMember = $ValueMember
	}
}



function Update-DataGridView {
	<#
	.SYNOPSIS
		This functions helps you load items into a DataGridView.

	.DESCRIPTION
		Use this function to dynamically load items into the DataGridView control.

	.PARAMETER  DataGridView
		The DataGridView control you want to add items to.

	.PARAMETER  Item
		The object or objects you wish to load into the DataGridView's items collection.
	
	.PARAMETER  DataMember
		Sets the name of the list or table in the data source for which the DataGridView is displaying data.

	.PARAMETER AutoSizeColumns
	    Resizes DataGridView control's columns after loading the items.
	#>
	Param (
		[ValidateNotNull()]
		[Parameter(Mandatory = $true)]
		[System.Windows.Forms.DataGridView]$DataGridView,
		[ValidateNotNull()]
		[Parameter(Mandatory = $true)]
		$Item,
		[Parameter(Mandatory = $false)]
		[string]$DataMember,
		[System.Windows.Forms.DataGridViewAutoSizeColumnsMode]$AutoSizeColumns = 'None'
	)
	$DataGridView.SuspendLayout()
	$DataGridView.DataMember = $DataMember
	
	if ($null -eq $Item) {
		$DataGridView.DataSource = $null
	}
	elseif ($Item -is [System.Data.DataSet] -and $Item.Tables.Count -gt 0) {
		$DataGridView.DataSource = $Item.Tables[0]
	}
	elseif ($Item -is [System.ComponentModel.IListSource]`
		-or $Item -is [System.ComponentModel.IBindingList] -or $Item -is [System.ComponentModel.IBindingListView]) {
		$DataGridView.DataSource = $Item
	}
	else {
		$array = New-Object System.Collections.ArrayList
		
		if ($Item -is [System.Collections.IList]) {
			$array.AddRange($Item)
		}
		else {
			$array.Add($Item)
		}
		$DataGridView.DataSource = $array
	}
	
	if ($AutoSizeColumns -ne 'None') {
		$DataGridView.AutoResizeColumns($AutoSizeColumns)
	}
	
	$DataGridView.ResumeLayout()
}



function ConvertTo-DataTable {
	<#
		.SYNOPSIS
			Converts objects into a DataTable.
	
		.DESCRIPTION
			Converts objects into a DataTable, which are used for DataBinding.
	
		.PARAMETER  InputObject
			The input to convert into a DataTable.
	
		.PARAMETER  Table
			The DataTable you wish to load the input into.
	
		.PARAMETER RetainColumns
			This switch tells the function to keep the DataTable's existing columns.
		
		.PARAMETER FilterCIMProperties
			This switch removes CIM properties that start with an underline.
	
		.EXAMPLE
			$DataTable = ConvertTo-DataTable -InputObject (Get-Process)
	#>
	[OutputType([System.Data.DataTable])]
	param (
		$InputObject,
		[ValidateNotNull()]
		[System.Data.DataTable]$Table,
		[switch]$RetainColumns,
		[switch]$FilterCIMProperties)
	
	if ($null -eq $Table) {
		$Table = New-Object System.Data.DataTable
	}
	
	if ($null -eq $InputObject) {
		$Table.Clear()
		return @( ,$Table)
	}
	
	if ($InputObject -is [System.Data.DataTable]) {
		$Table = $InputObject
	}
	elseif ($InputObject -is [System.Data.DataSet] -and $InputObject.Tables.Count -gt 0) {
		$Table = $InputObject.Tables[0]
	}
	else {
		if (-not $RetainColumns -or $Table.Columns.Count -eq 0) {
			#Clear out the Table Contents
			$Table.Clear()
			
			if ($null -eq $InputObject) { return } #Empty Data
			
			$object = $null
			#find the first non null value
			foreach ($item in $InputObject) {
				if ($null -ne $item) {
					$object = $item
					break
				}
			}
			
			if ($null -eq $object) { return } #All null then empty
			
			#Get all the properties in order to create the columns
			foreach ($prop in $object.PSObject.Get_Properties()) {
				if (-not $FilterCIMProperties -or -not $prop.Name.StartsWith('__'))  {#filter out CIM properties
					#Get the type from the Definition string
					$type = $null
					
					if ($null -ne $prop.Value) {
						try { $type = $prop.Value.GetType() }
						catch { Out-Null }
					}
					
					if ($null -ne $type)  {# -and [System.Type]::GetTypeCode($type) -ne 'Object')
						[void]$table.Columns.Add($prop.Name, $type)
					}
					else  {#Type info not found
						[void]$table.Columns.Add($prop.Name)
					}
				}
			}
			
			if ($object -is [System.Data.DataRow]) {
				foreach ($item in $InputObject) {
					$Table.Rows.Add($item)
				}
				return @( ,$Table)
			}
		}
		else {
			$Table.Rows.Clear()
		}
		
		foreach ($item in $InputObject) {
			$row = $table.NewRow()
			
			if ($item) {
				foreach ($prop in $item.PSObject.Get_Properties()) {
					if ($table.Columns.Contains($prop.Name)) {
						$row.Item($prop.Name) = $prop.Value
					}
				}
			}
			[void]$table.Rows.Add($row)
		}
	}
	
	return @( ,$Table)
}


#endregion

#region Generic functions
function GetFunctionName {
	param (
		[int]$StackNumber = -1,
		[switch]$NoNumberPrefix
	)
	$final = $null
	$finalln = 0
	if ($StackNumber -lt 0) {
		$num = (Get-PSCallStack).count
		while ($num -gt 1) {
			$num--
			[string]$StrName = (Get-PSCallStack)[$num].FunctionName
			[int]$intLineNo = (Get-PSCallStack)[$num].ScriptLineNumber
			if ($StrName -inotmatch "^\<.*\>$") {
				if ($NoNumberPrefix) {
					$final = "$StrName"
				}
				else {
					$final = "$StrName"
					$finalln = $intLineNo
				}
			}
		}
	}
	else {
		[string]$StrName = (Get-PSCallStack)[$StackNumber].FunctionName
		[int]$intLineNo = (Get-PSCallStack)[$StackNumber].ScriptLineNumber
	}
	if ($NoNumberPrefix) {
		if ($final.length -eq 0) {
			return "<main>"
		}
		else {
			return "$($final)"
		}
	}
	else {
		if ($finalln -eq 0) {
			[int]$finalln = (Get-PSCallStack)[1].ScriptLineNumber
		}
		if ($final.length -eq 0) {
			return "<main>: $($finalln)"
		}
		else {
			return "$($final): $($finalln)"
		}
	}
}

function Tracefile {
	[CmdletBinding()]
	Param (
		[parameter(Mandatory = $true)]
		[Alias("line")]
		[String]$Message,
		[parameter(Mandatory = $false)]
		[Alias("Function")]
		[String]$Component = $(GetFunctionName),
		[Parameter(Mandatory = $false)]
		[ValidateSet("Info", "Warning", "Error")]
		[String]$Type = "Info",
		[Parameter(Mandatory = $false, ValueFromPipeline = $true)]
		[string]$LogDir = "$($env:temp)\",
		[Parameter(Mandatory = $false, ValueFromPipeline = $true)]
		[switch]$NoNumberPrefix,
		[Parameter(Mandatory = $false, ValueFromPipeline = $true)]
		[switch]$ReturnLogName = $false
		
	)
	switch ($Type) {
		"Info" {
			[int]$Type = 1
		}
		"Warning" {
			[int]$Type = 2
		}
		"Error" {
			[int]$Type = 3
		}
	}
	if ($NoNumberPrefix) {
		[String]$Component = $(GetFunctionName -NoNumberPrefix)
	}
	$Content = "<![LOG[$Message]LOG]!>" +`
	"<time=`"$(Get-Date -Format "HH:mm:ss.ffffff")`" " +`
	"date=`"$(Get-Date -Format "M-d-yyyy")`" " +`
	"component=`"$Component`" " +`
	"context=`"$([System.Security.Principal.WindowsIdentity]::GetCurrent().Name)`" " +`
	"type=`"$Type`" " +`
	"thread=`"$([Threading.Thread]::CurrentThread.ManagedThreadId)`" " +`
	"file=`"`">"
	$logfile = Join-Path -Path "$($LogDir)" -ChildPath "$(
		if ($global:MyNameIs.Length -gt 1) {
			$global:MyNameIs
		}
		elseif ($HostInvocation) {
			$HostInvocation.MyCommand.Name -replace '\.[\w]{3}$', ''
		}
		elseif ($MyInvocation.Scriptname.Length -gt 1) {
			(Split-Path -Leaf $MyInvocation.Scriptname) -replace '\.[\w]{3}$', ''
		}
		elseif ($syncHash.ScriptName.Length -gt 1) {
			(Split-Path -Leaf $syncHash.ScriptName) -replace '\.[\w]{3}$', ''
		}
		elseif ($MyInvocation.PSCommandPath.Length -gt 1) {
			(Split-Path -Leaf $MyInvocation.PSCommandPath) -replace '\.[\w]{3}$', ''
		}
		else {
			"$($syncHash.AppName)"
		}
	)_$((Get-Date).ToString('yyyy-MM-dd')).cmtrace.log"
	
	Add-Content -Path $logfile -Value $Content -Encoding UTF8 -ErrorAction SilentlyContinue
	if ($ReturnLogName) {
		return $logfile
	}
}
#endregion

#region Table functions
function HideRows {
	foreach ($row in $datagridview1.rows) {
		foreach ($cell in $row.Cells) {
			if ($cell.OwningColumn.Name -eq "Name") {
				if ($cell.Value.Length -le 1) {
					$cell.OwningRow.Visible = $false
				}
				break
			}
		}
	}
}

function SelectRow {
	try {
		$textboxName.Text = ""
		$textboxSeason.Text = ""
		$textboxEpisode.Text = ""
		$textboxReleasegroup.Text = ""
		$index = 0
		while ($index -lt $checkedlistboxResolution.Items.Count) {
			$checkedlistboxResolution.SetItemChecked($index, $false)
			$checkedlistboxResolution.SetSelected($index, $false)
			$index++
		}
		$index = 0
		while ($index -lt $checkedlistboxSource.Items.Count) {
			$checkedlistboxSource.SetItemChecked($index, $false)
			$checkedlistboxSource.SetSelected($index, $false)
			$index++
		}
		$columnNames = @($datagridview1.Columns | Select-Object -ExpandProperty Name)
		$RowIndex = $datagridview1.SelectedCells[0].RowIndex
		$ColumnIndex = 0
		foreach ($columnName in $columnNames) {
			$cell = $datagridview1.Rows[$RowIndex].Cells[$ColumnIndex]
			if ($cell.Value -eq $null -or $cell.Value.Length -lt 1) {
				$ColumnIndex++
				continue
			}
			if ($columnName -eq "Name") {
				$textboxName.Text = $cell.Value
			}
			if ($columnName -eq "Resolution") {
				for ($i = 0; $i -lt $checkedlistboxResolution.Items.Count; $i++) {
					if ($checkedlistboxResolution.Items[$i] -ieq $cell.Value) {
						$index = $i
						break
					}
				}
				$checkedlistboxResolution.SetItemChecked($index, $true)
				$checkedlistboxResolution.SetSelected($index, $true)
			}
			if ($columnName -eq "Source") {
				for ($i = 0; $i -lt $checkedlistboxSource.Items.Count; $i++) {
					if ($checkedlistboxSource.Items[$i] -ieq $cell.Value) {
						$index = $i
						break
					}
				}
				$checkedlistboxSource.SetSelected($index, $true)
			}
			if ($columnName -eq "Season") {
				$textboxSeason.Text = $cell.Value
			}
			if ($columnName -eq "Episode") {
				$textboxEpisode.Text = $cell.Value
			}
			$ColumnIndex++
		}
	}
	catch {
	}
}

function ShowTable {
	HideRSSKey
	$datagridview1.Visible = $true
	$buttonBookmark.Visible = $true
	$buttonRefresh.Visible = $true
	$labelName.Visible = $true
	$labelSeason.Visible = $true
	$labelEpisode.Visible = $true
	$labelResolution.Visible = $true
	$labelSource.Visible = $true
	$labelReleasegroup.Visible = $true
	$textboxName.Visible = $true
	$textboxSeason.Visible = $true
	$textboxEpisode.Visible = $true
	$checkedlistboxResolution.Visible = $true
	$checkedlistboxSource.Visible = $true
	$textboxReleasegroup.Visible = $true
}

function HideTable {
	$datagridview1.Visible = $false
	$buttonBookmark.Visible = $false
	$buttonRefresh.Visible = $false
	$labelName.Visible = $false
	$labelSeason.Visible = $false
	$labelEpisode.Visible = $false
	$labelResolution.Visible = $false
	$labelSource.Visible = $false
	$labelReleasegroup.Visible = $false
	$textboxName.Visible = $false
	$textboxSeason.Visible = $false
	$textboxEpisode.Visible = $false
	$checkedlistboxResolution.Visible = $false
	$checkedlistboxSource.Visible = $false
	$textboxReleasegroup.Visible = $false
}

function UpdateTable {
	if ($syncHash.RSSElements.count -eq 0) {
		return
	}
	$table = ConvertTo-DataTable -InputObject $syncHash.RSSElements
	Update-DataGridView -DataGridView $datagridview1 -Item $table -AutoSizeColumns AllCells
	foreach ($tableName in $syncHash.HideTableColumnNames) {
		$datagridview1.Columns[$tableName].Visible = $false
	}
	$formRSSTVDownloader.Refresh()
}
#endregion

#region Menu functions
function HideRSSKey {
	$labelInput.Visible = $false
	$textboxInput.Visible = $false
	$textboxInput.Text = ""
	$buttonSave.Visible = $false
	$buttonCancel.Visible = $false
}

function UncheckRSSIntervals {
	$ToolStripMenuItemRSS1minute.Checked = $false
	$ToolStripMenuItemRSS2minutes.Checked = $false
	$ToolStripMenuItemRSS5minutes.Checked = $false
	$ToolStripMenuItemRSS10minutes.Checked = $false
	$ToolStripMenuItemRSS30minutes.Checked = $false
	$ToolStripMenuItemRSS10minutes.Checked = $false
	$ToolStripMenuItemRSS2hours.Checked = $false
	$ToolStripMenuItemRSSPause.Checked = $false
}

function UpdateRSSIntervals {
	$null = New-ItemProperty -Path $syncHash.RegBase -Name "RSSInterval" -Value $syncHash.RSSInterval -PropertyType DWord -Force -ErrorAction Stop
	if ($syncHash.AsyncCommand -ne "None" -and $syncHash.RSSInterval -ne 0) {
		$timer1.Interval = $syncHash.RSSInterval * 1000
	}
	$syncHash.AsyncCommand = "UpdateAll"
}

function UncheckBacklog {
	$previousOnlyToolStripMenuItem.Checked = $false
	$twoPreviousToolStripMenuItem.Checked = $false
	$fivePreviousToolStripMenuItem.Checked = $false
	$anyInSeasonToolStripMenuItem.Checked = $false
	$allPreviousToolStripMenuItem.Checked = $false
	$noneToolStripMenuItem.Checked = $false
}

function UpdateBacklog {
	$null = New-ItemProperty -Path $syncHash.RegBase -Name "BacklogInterval" -Value $syncHash.Backlog -Force -ErrorAction Stop
}

function ShowInfoBox {
	$richtextboxFirstInfo.Visible = $true
	$richtextboxFirstInfo.Text = ""
	$richtextboxFirstInfo.SelectionColor = [System.Drawing.SystemColors]::ControlLight
	$richtextboxFirstInfo.AppendText("`r`nWelcome as a guineapig for the ")
	$richtextboxFirstInfo.SelectionColor = [System.Drawing.Color]::Green
	$richtextboxFirstInfo.AppendText("$($syncHash.AppName)!")
	$richtextboxFirstInfo.SelectionColor = [System.Drawing.SystemColors]::ControlLight
	$richtextboxFirstInfo.AppendText(" (fanfare playing)`r`n`r`nThis small app will help you download TV-series torrentsites RSS-feeds.`r`n")
	$richtextboxFirstInfo.AppendText("First off you need to find your RSS Access key for the site you have access to. Activate the site in the menu and enter the key.`r`n")
	$richtextboxFirstInfo.AppendText("`r`nOnce that is done you should see a table with tv-torrents availible.`r`n")
	$richtextboxFirstInfo.AppendText("Bookmark the shows you prefer by either clicking the correct show or manually type in the info.`r`n")
	$richtextboxFirstInfo.AppendText("See the options to adjust RSS update frequency or number of shows allowed in backlog and other stuff.`r`n")
	$richtextboxFirstInfo.AppendText("`r`nIf you find a bug dont`'t hesitate to PM me (psxc) and I`'ll have it fixed.`r`n")
	$richtextboxFirstInfo.AppendText("Currently the `'repack`' part may be wonky - I`'ll be sure to fix it soon.`r`n")
	$richtextboxFirstInfo.AppendText("`r`nA logfile with minimal info will be written in you %temp% directory.`r`n")
	$richtextboxFirstInfo.AppendText("`r`nYour current preferences are saved in the registry, under HKCU:\Software\$($syncHash.AppName) - now you know.`r`n")
}

function HideInfoBox {
	$richtextboxFirstInfo.Visible = $false
}
#endregion

#region Bookmarks functions
function UpdateBookmarksMenu {
	$removeBookmarkToolStripMenuItem.DropDownItems.Clear()
	foreach ($bookmark in $syncHash.Bookmarks | Sort-Object -Property Name) {
		[array]$SeasonEpisodes = @()
		foreach ($SeasonEpisode in $bookmark.Episodes) {
			$SeasonEpisodes += [PSCustomObject]@{
				Season = [int]($SeasonEpisode / 1000)
				Episode = [int]($SeasonEpisode % 1000)
			}
		}
		$SeasonEpisode = $SeasonEpisodes | Sort-Object -Property Season, Episode -Descending | Select-Object -First 1
		$strEpisode = "(Latest: S{0:00}" -f $SeasonEpisode.Season + "E{0:00})" -f $SeasonEpisode.Episode
		$name = "$($bookmark.Name) $strEpisode"
		$NameItem = $removeBookmarkToolStripMenuItem.DropDownItems.Add($name)
		$NameItem.Tag = "Name:$($bookmark.Name)"
		$NameItem.Add_Click(
			{
				RemoveBookmark -bookmark $($this.Tag)
			}
		)
		if ($bookmark.ReleaseGroups.Count -gt 0) {
			$SubItem = $NameItem.DropDownItems.Add("ReleaseGroups")
			$subItem.Tag = "ReleaseGroup:$($bookmark.Name)"
			$subItem.Add_Click(
				{
					RemoveBookmark -bookmark $($this.Tag)
				}
			)
			foreach ($ReleaseGroup in $bookmark.ReleaseGroups) {
				$subSubItem = $SubItem.DropDownItems.Add($ReleaseGroup)
				$subSubItem.Tag = "ReleaseGroup:$($bookmark.Name)|$($ReleaseGroup)"
				$subSubItem.Add_Click(
					{
						RemoveBookmark -bookmark $($this.Tag)
					}
				)
			}
		}
		if ($bookmark.Resolutions.Count -gt 0) {
			$SubItem = $NameItem.DropDownItems.Add("Resolutions")
			$subItem.Tag = "Resolution:$($bookmark.Name)"
			$subItem.Add_Click(
				{
					RemoveBookmark -bookmark $($this.Tag)
				}
			)
			foreach ($Resolution in $bookmark.Resolutions) {
				$subSubItem = $SubItem.DropDownItems.Add($Resolution)
				$subSubItem.Tag = "Resolution:$($bookmark.Name)|$($Resolution)"
				$subSubItem.Add_Click(
					{
						RemoveBookmark -bookmark $($this.Tag)
					}
				)
			}
		}
		if ($bookmark.Sources.Count -gt 0) {
			$SubItem = $NameItem.DropDownItems.Add("Sources")
			$subItem.Tag = "Source:$($bookmark.Name)"
			$subItem.Add_Click(
				{
					RemoveBookmark -bookmark $($this.Tag)
				}
			)
			foreach ($Source in $bookmark.Sources) {
				$subSubItem = $SubItem.DropDownItems.Add($Source)
				$subSubItem.Tag = "Source:$($bookmark.Name)|$($Source)"
				$subSubItem.Add_Click(
					{
						RemoveBookmark -bookmark $($this.Tag)
					}
				)
			}
		}
	}
	Set-ControlTheme -Control $formRSSTVDownloader -Theme $syncHash.ThemeColor
}
	
function RemoveBookmark {
	param (
		[string]$bookmark = ""
	)
	if ($bookmark.StartsWith("Name:")) {
		$Name = $bookmark -replace 'Name:', ''
		Remove-Item -Path "$($syncHash.RegBase)\Bookmarks\$($Name)" -Recurse -Force
	}
	elseif ($bookmark.StartsWith("ReleaseGroup")) {
		$line = $bookmark -replace 'ReleaseGroup:', ''
		$Name = ($line -split '\|')[0]
		$ReleaseGroup = ($line -split '\|')[1]
		if ($ReleaseGroup.Length -eq 0) {
			Remove-Item -Path "$($syncHash.RegBase)\Bookmarks\$($Name)\ReleaseGroups" -Recurse -Force
		}
		else {
			Remove-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$($Name)\ReleaseGroups" -Name $ReleaseGroup -Force
		}
	}
	elseif ($bookmark.StartsWith("Resolution")) {
		$line = $bookmark -replace 'Resolution:', ''
		$Name = ($line -split '\|')[0]
		$Resolution = ($line -split '\|')[1]
		if ($Resolution.Length -eq 0) {
			Remove-Item -Path "$($syncHash.RegBase)\Bookmarks\$($Name)\Resolutions" -Recurse -Force
		}
		else {
			Remove-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$($Name)\Resolutions" -Name $Resolution -Force
		}
	}
	elseif ($bookmark.StartsWith("Source")) {
		$line = $bookmark -replace 'Source:', ''
		$Name = ($line -split '\|')[0]
		$Source = ($line -split '\|')[1]
		if ($Source.Length -eq 0) {
			Remove-Item -Path "$($syncHash.RegBase)\Bookmarks\$($Name)\Sources" -Recurse -Force
		}
		else {
			Remove-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$($Name)\Sources" -Name $Source -Force
		}
	}
	
	$syncHash.AsyncCommand = "ReadBookmarks"
	#ReadBookmarks
	#UpdateBookmarksMenu
}

function AddBookmark {
	$resolutions = $checkedlistboxResolution.CheckedItems.Count
	$sources = $checkedlistboxSource.CheckedItems.Count
	$bookmarkName = ($textboxName.Text -replace $($syncHash.regexWordDelimeter), ' ').Trim()
	if (-not ($bookmarkName.Length -gt 1 -and $textboxSeason.Text.Length -gt 0 -and [int]$textboxSeason.Text -gt 0 - $textboxEpisode.Text.Length -gt 0)) {
		return
	}
	if (-not (Test-Path -Path "$($syncHash.RegBase)\Bookmarks")) {
		$null = New-Item -Path "$($syncHash.RegBase)\Bookmarks" -ItemType Directory -Force -ErrorAction Stop
	}
	if (-not (Test-Path -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)")) {
		$null = New-Item -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)" -ItemType Directory -Force -ErrorAction Stop
		$null = New-Item -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)\Resolutions" -ItemType Directory -Force -ErrorAction Stop
		$null = New-Item -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)\Sources" -ItemType Directory -Force -ErrorAction Stop
		$null = New-Item -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)\ReleaseGroups" -ItemType Directory -Force -ErrorAction Stop
	}
	foreach ($resolution in $checkedlistboxResolution.CheckedItems) {
		$null = New-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)\Resolutions" -Name "$($resolution.ToString())" -Force -ErrorAction Stop
	}
	foreach ($source in $checkedlistboxSource.CheckedItems) {
		$null = New-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)\Sources" -Name "$($source.ToString())" -Force -ErrorAction Stop
	}
	if ($textboxReleasegroup.Text.Trim().Length -gt 1) {
		$null = New-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)\ReleaseGroups" -Name "$($textboxReleasegroup.Text.Trim())" -Force -ErrorAction Stop
	}
	if ($checkboxIncludeAllPreviousEp.Checked -eq $true) {
		$firstEp = 1
	}
	else {
		$firstEp = [int]$textboxEpisode.Text
	}
	$currEp = [int]$textboxEpisode.Text
	while ($currEp -ge $firstEp) {
		$null = New-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)" -Name "Episode:$(([int]$textboxSeason.Text) * 1000 + $currEp)" -Force -ErrorAction Stop
		$currEp--
	}
	UpdateBookmarksMenu
}
#endregion

#region update functions
function createWordRegex {
	param (
		[array]$elements = @()
	)
	[array]$escapedChars = @('-', ' ', '.', "'", '\', '/')
	[array]$words = @()
	foreach ($element in $elements) {
		[string]$word = $syncHash.regexWordDelimeter
		foreach ($char in $element.ToCharArray()) {
			$word += '['
			$temp1 = [char]::ToUpper($char)
			$temp2 = [char]::ToLower($char)
			if ($temp1 -in $escapedChars) {
				$word += '\'
			}
			$word += $temp1
			if ($temp1 -cne $temp2) {
				$word += $temp2
			}
			$word += ']'
		}
		$word += $syncHash.regexWordDelimeter
		$words += $word
	}
	$strWords = $words -join '|'
	return $strWords
}

function UpdateTVSources {
	try {
		$strSources = Get-ItemPropertyValue -Path $syncHash.RegBase -Name "TVSources" -ErrorAction Stop
	}
	catch {
		$strSources = ""
	}
	[array]$sources = ($syncHash.TVSource + $($strSources -split '\|') | Sort-Object -Unique).Where({ -not [string]::IsNullOrWhiteSpace($_) })
	$syncHash.TVSource = $sources
	$strSources = $sources -join '|'
	New-ItemProperty -Path $syncHash.RegBase -Name "TVSources" -PropertyType String -Value $strSources -Force -ErrorAction Stop
	$checkedlistboxSource.Items.Clear()
	foreach ($item in $($syncHash.TVSource | Sort-Object -Unique)) {
		$checkedlistboxSource.Items.Add($item)
	}
}

function UpdateTVResolutions {
	try {
		$strResolutions = Get-ItemPropertyValue -Path $syncHash.RegBase -Name "TVResolutions" -ErrorAction Stop
	}
	catch {
		$strResolutions = ""
	}
	[array]$Resolutions = ($syncHash.TVResolution + $($strResolutions -split '\|') | Sort-Object -Unique).Where({ -not [string]::IsNullOrWhiteSpace($_) })
	$syncHash.TVResolution = $Resolutions
	$strResolutions = $Resolutions -join '|'
	New-ItemProperty -Path $syncHash.RegBase -Name "TVResolutions" -PropertyType String -Value $strResolutions -Force -ErrorAction Stop
	$checkedlistboxResolution.Items.Clear()
	foreach ($item in $($syncHash.TVResolution | Sort-Object { [int]($_ -replace '\D') })) {
		$checkedlistboxResolution.Items.Add($item)
	}
}
#endregion

#region SitesMenu functions
function CreateSitesMenu {
	$sitesToolStripMenuItem.DropDownItems.Clear()
	[array]$syncHash.sitesInfo = @()
	foreach ($site in @((Get-Item -Path "$($syncHash.RegBase)\Sites\*").Name | ForEach-Object { ($_.split('\')[-1]) })) {
		$siteProperties = Get-ItemProperty -Path "$($syncHash.RegBase)\Sites\$site"
		$RSSKey = [string]$siteProperties.RSSKey
		$syncHash.sitesInfo += [PSCustomObject]@{
			Name = $site
			Url  = [string]$siteProperties.URL -replace '<RSSKEY>', $RSSKey
			CategoryKey = [string]$siteProperties.CategoryKey
			Categories = [array]@([string]$siteProperties.Categories -split ',')
			Enabled = [int]$siteProperties.Enabled
		}
		$SiteItem = $sitesToolStripMenuItem.DropDownItems.Add($site)
		$SiteItem.Tag = "$site"
		$SiteItem.Add_Click(
			{
				ToggleActivate -siteItem $this
			}
		)
		if ($RSSKey.Length -gt 1 -and $siteProperties.Enabled -eq 1) {
			$SiteItem.Checked = $true
		}
		else {
			$SiteItem.Checked = $false
		}
		$SubSiteItem = $SiteItem.DropDownItems.Add("Set RSSKey")
		$SubSiteItem.Tag = "$site"
		$SubSiteItem.Add_Click(
			{
				$syncHash.CurrentSite = $this.Tag
				& $rSSKeyToolStripMenuItem_Click
			}
		)
	}
	Set-ControlTheme -Control $formRSSTVDownloader -Theme $syncHash.ThemeColor
}

function ToggleActivate {
	param (
		$siteItem
	)
	$syncHash.CurrentSite = $siteItem.Tag
	if ((Get-ItemPropertyValue -Path "$($syncHash.RegBase)\Sites\$($syncHash.CurrentSite)" -Name "RSSKey" -ErrorAction Stop).Length -le 1) {
		& $rSSKeyToolStripMenuItem_Click
	}
	else {
		if ((Get-ItemPropertyValue -Path "$($syncHash.RegBase)\Sites\$($syncHash.CurrentSite)" -Name "Enabled" -ErrorAction Stop) -ne 1) {
			$siteItem.Checked = $true
			New-ItemProperty -Path "$($syncHash.RegBase)\Sites\$($syncHash.CurrentSite)" -Name "Enabled" -PropertyType DWord -Value 1 -Force -ErrorAction Stop
		}
		else {
			$siteItem.Checked = $false
			New-ItemProperty -Path "$($syncHash.RegBase)\Sites\$($syncHash.CurrentSite)" -Name "Enabled" -PropertyType DWord -Value 0 -Force -ErrorAction Stop
		}
		#CreateSitesMenu
	}
}
#endregion

#region ASync
function StartAsync {
	param (
		$RemoteHashName = "syncHash",
		$AsyncScript = { }
	)
	$syncHash.TimerWait = $true
	$syncHash.TimerStart = (Get-Date).ToUniversalTime().Ticks
	$syncRunspace = [runspacefactory]::CreateRunspace()
	$syncRunspace.Open()
	$syncRunspace.SessionStateProxy.SetVariable($RemoteHashName, $syncHash)
	$syncPowershell = [powershell]::Create()
	$syncPowershell.Runspace = $syncRunspace
	$null = $syncPowershell.AddScript($asyncScript)
	$syncHandle = $syncPowershell.BeginInvoke()
}

$asyncScript = {
	#region Async functions
	function GetFunctionName {
		param (
			[int]$StackNumber = -1,
			[switch]$NoNumberPrefix
		)
		$final = $null
		$finalln = 0
		if ($StackNumber -lt 0) {
			$num = (Get-PSCallStack).count
			while ($num -gt 1) {
				$num--
				[string]$StrName = (Get-PSCallStack)[$num].FunctionName
				[int]$intLineNo = (Get-PSCallStack)[$num].ScriptLineNumber
				if ($StrName -inotmatch "^\<.*\>$") {
					if ($NoNumberPrefix) {
						$final = "$StrName"
					}
					else {
						$final = "$StrName"
						$finalln = $intLineNo
					}
				}
			}
		}
		else {
			[string]$StrName = (Get-PSCallStack)[$StackNumber].FunctionName
			[int]$intLineNo = (Get-PSCallStack)[$StackNumber].ScriptLineNumber
		}
		if ($NoNumberPrefix) {
			if ($final.length -eq 0) {
				return "<main>"
			}
			else {
				return "$($final)"
			}
		}
		else {
			if ($finalln -eq 0) {
				[int]$finalln = (Get-PSCallStack)[1].ScriptLineNumber
			}
			if ($final.length -eq 0) {
				return "<main>: $($finalln)"
			}
			else {
				return "$($final): $($finalln)"
			}
		}
	}
	
	function Tracefile {
		[CmdletBinding()]
		Param (
			[parameter(Mandatory = $true)]
			[Alias("line")]
			[String]$Message,
			[parameter(Mandatory = $false)]
			[Alias("Function")]
			[String]$Component = $(GetFunctionName),
			[Parameter(Mandatory = $false)]
			[ValidateSet("Info", "Warning", "Error")]
			[String]$Type = "Info",
			[Parameter(Mandatory = $false, ValueFromPipeline = $true)]
			[string]$LogDir = "$($env:temp)\",
			[Parameter(Mandatory = $false, ValueFromPipeline = $true)]
			[switch]$NoNumberPrefix,
			[Parameter(Mandatory = $false, ValueFromPipeline = $true)]
			[switch]$ReturnLogName = $false
			
		)
		switch ($Type) {
			"Info" {
				[int]$Type = 1
			}
			"Warning" {
				[int]$Type = 2
			}
			"Error" {
				[int]$Type = 3
			}
		}
		if ($NoNumberPrefix) {
			[String]$Component = $(GetFunctionName -NoNumberPrefix)
		}
		$Content = "<![LOG[$Message]LOG]!>" +`
		"<time=`"$(Get-Date -Format "HH:mm:ss.ffffff")`" " +`
		"date=`"$(Get-Date -Format "M-d-yyyy")`" " +`
		"component=`"$Component`" " +`
		"context=`"$([System.Security.Principal.WindowsIdentity]::GetCurrent().Name)`" " +`
		"type=`"$Type`" " +`
		"thread=`"$([Threading.Thread]::CurrentThread.ManagedThreadId)`" " +`
		"file=`"`">"
		$logfile = Join-Path -Path "$($LogDir)" -ChildPath "$(
			if ($global:MyNameIs.Length -gt 1) {
				$global:MyNameIs
			}
			elseif ($HostInvocation) {
				$HostInvocation.MyCommand.Name -replace '\.[\w]{3}$', ''
			}
			elseif ($MyInvocation.Scriptname.Length -gt 1) {
				(Split-Path -Leaf $MyInvocation.Scriptname) -replace '\.[\w]{3}$', ''
			}
			elseif ($syncHash.ScriptName.Length -gt 1) {
				(Split-Path -Leaf $syncHash.ScriptName) -replace '\.[\w]{3}$', ''
			}
			elseif ($MyInvocation.PSCommandPath.Length -gt 1) {
				(Split-Path -Leaf $MyInvocation.PSCommandPath) -replace '\.[\w]{3}$', ''
			}
			else {
				"$($syncHash.AppName)"
			}
		)_$((Get-Date).ToString('yyyy-MM-dd')).cmtrace.log"
		
		Add-Content -Path $logfile -Value $Content -Encoding UTF8 -ErrorAction SilentlyContinue
		if ($ReturnLogName) {
			return $logfile
		}
	}
	
	function MatchRSSToBookmarks {
		#Tracefile -Message "DEBUG: Start: $(Get-Date)"
		[array]$syncHash.MatchedRSSHits = @()
		foreach ($bookmark in $syncHash.Bookmarks) {
			$bookmarkName = $bookmark.Name -replace $($syncHash.regexWordDelimeter), $($syncHash.regexWordDelimeter)
			$RSSElements = $syncHash.RSSElements | Where-Object -Property Name -Match "^$bookmarkName$"
			foreach ($RSSElement in $RSSElements) {
				$okResolution = $false
				if ($bookmark.Resolutions.count -ge 1) {
					foreach ($BookmarkResolution in $bookmark.Resolutions) {
						if ($RSSElement.Resolution -eq $BookmarkResolution) {
							$okResolution = $true
							continue
						}
					}
				}
				else {
					$okResolution = $true
				}
				if ($okResolution -eq $false) {
					continue
				}
				$okSource = $false
				if ($bookmark.Sources.count -ge 1) {
					foreach ($BookmarkSource in $bookmark.Sources) {
						if ($RSSElement.Source -eq $BookmarkSource) {
							$okSource = $true
							continue
						}
					}
				}
				else {
					$okSource = $true
				}
				if ($okSource -eq $false) {
					continue
				}
				
				$okReleaseGroup = $false
				if ($bookmark.ReleaseGroups.count -ge 1) {
					foreach ($BookmarkReleaseGroup in $bookmark.ReleaseGroups) {
						if ($RSSElement.Group -eq $BookmarkReleaseGroup) {
							$okReleaseGroup = $true
							continue
						}
					}
				}
				else {
					$okReleaseGroup = $true
				}
				if ($okReleaseGroup -eq $false) {
					continue
				}
				$syncHash.MatchedRSSHits += $RSSElement
			}
		}
		#Tracefile -Message "DEBUG: END: $(Get-Date)"
	}
	
	function SanitizeMatchedRSSHits {
		#Tracefile -Message "DEBUG: Start: $(Get-Date)"
		[array]$MarkedForDownload = @()
		[int]$allowedBacklogSeasonDiff = $($syncHash.Backlog -split ':')[0]
		[int]$allowedBacklogEpisodeDiff = $($syncHash.Backlog -split ':')[1]
		foreach ($MatchedRSSHit in $syncHash.MatchedRSSHits) {
			foreach ($bookmark in $syncHash.Bookmarks) {
				$bookmarkName = $bookmark.Name -replace $($syncHash.regexWordDelimeter), $($syncHash.regexWordDelimeter)
				if ($MatchedRSSHit.Name -imatch "^$bookmarkName$") {
					[int]$latestBookmarkedEpisode = $bookmark.Episodes | Sort-Object | Select-Object -Last 1
					[int]$bookmarkSeason = [int]($latestBookmarkedEpisode / 1000)
					[int]$bookmarkEpisode = [int]($latestBookmarkedEpisode % 1000)
					# Show title matched
					$allowEpisode = $false
					$matchedSeasonEpisode = [int]$MatchedRSSHit.Season * 1000 + [int]$MatchedRSSHit.Episode
					$bookmarkSeasonEpisode = [int]$bookmarkSeason * 1000 + [int]$bookmarkEpisode
					$RepackedAlreadyDownloaded = $matchedSeasonEpisode -in $bookmark.Repacks
					if (([int]$MatchedRSSHit.Season + $allowedBacklogSeasonDiff) -ge $bookmarkSeason) {
						# Season allowed
						if ([int]$MatchedRSSHit.Episode -gt $bookmarkEpisode) {
							$allowEpisode = $true
						}
						else {
							if (($bookmarkSeasonEpisode - $matchedSeasonEpisode) -le $allowedBacklogEpisodeDiff) {
								# episodenumber in allowed range
								if ($matchedSeasonEpisode -notin $bookmark.Episodes) {
									#episodenumber missing - download
									$allowEpisode = $true
								}
								elseif (($syncHash.DownloadRepack -eq $true) -and ($MatchedRSSHit.Repack) -and (-not $RepackedAlreadyDownloaded)) {
									#episodenumber is repacked
									$allowEpisode = $true
								}
								else {
									#check for autotrade
									if ($MatchedRSSHit.Linkname -in $bookmark.Dates) {
										continue
									}
									$previous = $bookmark.Dates -imatch ($MatchedRSSHit.LinkName -split ':')[1]
									if ($previous) {
										try {
											$MatchedDate = [DateTime]([long](($previous -split ':')[0]))
											if (($MatchedDate -lt $MatchedRSSHit.Date) -and ($MatchedDate.AddHours($syncHash.RepackHours) -gt $MatchedRSSHit.Date)) {
												$allowEpisode = $true
											}
										}
										catch {
											Tracefile -Message "ERROR: $($_.ToString())" -Type Error
										}
									}
								}
							}
						}
						else {
							$allowEpisode = $true
						}
					}
					if ($allowEpisode -eq $true) {
						$MarkedForDownload += $MatchedRSSHit
					}
				}
			}
		}
		$syncHash.ToDownload = @()
		$TempList = @()
		foreach ($Hit in $MarkedForDownload | Sort-Object -Property Name, Season, Episode) {
			$TempLine = "$($Hit.Name) $($Hit.Season) $($Hit.Episode)"
			if ($TempLine -notin $TempList) {
				$TempList += $TempLine
				$syncHash.ToDownload += $Hit
			}
		}
		#Tracefile -Message "DEBUG: END: $(Get-Date)"
		#Tracefile -Message "DEBUG -----" -Type Warning
	}
	
	function UpdateRegistryAfterDownload {
		foreach ($Downloaded in $syncHash.ToDownload) {
			$bookmarkName = $Downloaded.Name -replace $($syncHash.regexWordDelimeter), ' '
			[int]$DownloadedSeason = $Downloaded.Season
			[int]$DownloadedEpisode = $Downloaded.Episode
			$SeasonEpisode = $($DownloadedSeason * 1000 + $DownloadedEpisode)
			$LinkName = $Downloaded.LinkName
			$Ticks = $Downloaded.Date.Ticks
			if ($Downloaded.Repack.Length -gt 1) {
				New-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)" -Name "Episode:$SeasonEpisode" -Value "$($LinkName)|$($Downloaded.Repack)" -PropertyType String -Force -ErrorAction Stop
			}
			else {
				New-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)" -Name "Episode:$SeasonEpisode" -Value "$($LinkName)|" -Force -ErrorAction Stop
			}
			[int]$allowedBacklogSeasonDiff = $($syncHash.Backlog -split ':')[0]
			[int]$allowedBacklogEpisodeDiff = $($syncHash.Backlog -split ':')[1]
			
			[array]$SeasonEpisodes = ((Get-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)").PSObject.Properties | Where-Object { $_.Name -imatch 'Episode:' }).Name -replace 'Episode:' | Sort-Object -Descending
			do {
				[int]$LatestSeason = [int](($SeasonEpisodes | Select-Object -First 1) / 1000)
				[int]$LatestEpisode = [int](($SeasonEpisodes | Select-Object -First 1) % 1000)
				[int]$OldestSeason = [int](($SeasonEpisodes | Select-Object -Last 1) / 1000)
				[int]$OldestEpisode = [int](($SeasonEpisodes | Select-Object -Last 1) % 1000)
				
				if ($($LatestSeason - $OldestSeason) -gt $allowedBacklogSeasonDiff) {
					Remove-ItemProperty "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)" -Name "Episode:$($OldestSeason * 1000 + $OldestEpisode)" -Force -ErrorAction Stop
				}
				[array]$SeasonEpisodes = ((Get-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)").PSObject.Properties | Where-Object { $_.Name -imatch 'Episode:' }).Name -replace 'Episode:' | Sort-Object -Descending
			}
			while (($LatestSeason - $OldestSeason) -gt $allowedBacklogSeasonDiff)
			
			[array]$SeasonEpisodes = ((Get-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)").PSObject.Properties | Where-Object { $_.Name -imatch 'Episode:' }).Name -replace 'Episode:' | Sort-Object -Descending
			do {
				[int]$LatestSeason = [int](($SeasonEpisodes | Select-Object -First 1) / 1000)
				[int]$LatestEpisode = [int](($SeasonEpisodes | Select-Object -First 1) % 1000)
				[int]$OldestSeason = [int](($SeasonEpisodes | Select-Object -Last 1) / 1000)
				[int]$OldestEpisode = [int](($SeasonEpisodes | Select-Object -Last 1) % 1000)
				
				if ($($LatestEpisode - $OldestEpisode) -gt $allowedBacklogEpisodeDiff) {
					Remove-ItemProperty "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)" -Name "Episode:$($OldestSeason * 1000 + $OldestEpisode)" -Force -ErrorAction Stop
				}
				[array]$SeasonEpisodes = ((Get-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$($bookmarkName)").PSObject.Properties | Where-Object { $_.Name -imatch 'Episode:' }).Name -replace 'Episode:' | Sort-Object -Descending
			}
			while (($LatestEpisode - $OldestEpisode) -gt $allowedBacklogEpisodeDiff)
		}
	}
	
	function UpdateRSS {
		#Tracefile -Message "DEBUG: Start: $(Get-Date)"
		[array]$syncHash.RSSElements = @()
		foreach ($site in $syncHash.sitesInfo) {
			if ($site.Enabled -eq 0) {
				continue
			}
			try {
				$feed = Invoke-RestMethod -Uri $site.URL -UseBasicParsing -ErrorAction Stop
				[array]$sstringElements = @("title", "link")
				if ($site.CategoryKey.Length -gt 1) {
					$sstringElements += $site.CategoryKey
				}
				foreach ($feedElement in $feed) {
					$TitleCategoryLink = @{ }
					$Episode = $null
					$Season = $null
					$SeasonEpisode = ""
					$Source = ""
					$Resolution = ""
					$labelName = ""
					$Repack = ""
					$Date = [datetime]$($feedElement.pubDate)
					foreach ($sstring in $sstringElements) {
						$string = $feedElement.InnerXml -split '\n' | Select-String "\<$sstring\>"
						$regmatches = [regex]::Matches($string, $syncHash.RSSregex)
						$TitleCategoryLink.Add($sstring, $regmatches[0].Groups['data'].Value)
					}
					if (($site.CategoryKey.Length -le 1) -or ($TitleCategoryLink.$($site.CategoryKey) -in $site.Categories)) {
						try {
							[string]$Season = "{0:00}" -f [int](([regex]::Matches($TitleCategoryLink.Title, $syncHash.regexTVEpisodesGroup))[0].Groups['season'].Value)
							[string]$Episode = "{0:00}" -f [int](([regex]::Matches($TitleCategoryLink.Title, $syncHash.regexTVEpisodesGroup))[0].Groups['episode'].Value)
						}
						catch {
						}
						try {
							$Source = ([regex]::Matches($TitleCategoryLink.Title, $syncHash.regexTVSource))[0].Groups['source'].Value.TrimEnd($syncHash.regexWordDelimeter).TrimStart($syncHash.regexWordDelimeter)
						}
						catch {
						}
						try {
							$Resolution = ([regex]::Matches($TitleCategoryLink.Title, $syncHash.regexTVResolution))[0].Groups['resolution'].Value.TrimEnd($syncHash.regexWordDelimeter).TrimStart($syncHash.regexWordDelimeter)
						}
						catch {
						}
						try {
							$Repack = ([regex]::Matches($TitleCategoryLink.Title, $syncHash.regexTVRepack))[0].Groups['repack'].Value.TrimEnd($syncHash.regexWordDelimeter).TrimStart($syncHash.regexWordDelimeter)
						}
						catch {
						}
						try {
							$labelName = ([regex]::Matches($TitleCategoryLink.Title, $syncHash.regexTVName))[0].Groups['name'].Value -replace '[_|\.|\ ]+', ' '
						}
						catch {
						}
						try {
							$Group = ([regex]::Matches($TitleCategoryLink.Title, $syncHash.regexTVGroup))[0].Groups['group'].Value
						}
						catch {
						}
						$TradeSource = $Source
						foreach ($key in $syncHash.TVSourceGroups.Keys) {
							if ($source -in $syncHash.TVSourceGroups.$key) {
								$TradeSource = $key
							}
						}
						$LinkName = "$($Date.Ticks):" + $("$($labelName)$($Season)$($Episode)$($TradeSource)$($Resolution)$($Group)" -replace '[^a-zA-Z0-9]')
						if ($labelName.Length -gt 1) {
							$syncHash.RSSElements += [PSCustomObject]@{
								Date	   = $Date
								Site	   = $site.Name
								Category   = $TitleCategoryLink.Category
								Title	   = $TitleCategoryLink.Title
								Link	   = $TitleCategoryLink.Link
								LinkName   = $LinkName
								Name	   = $labelName
								Season	   = $Season
								Episode    = $Episode
								Source	   = $Source
								Resolution = $Resolution
								Group	   = $Group
								Repack	   = $Repack
							}
						}
					}
				}
			}
			catch {
				Tracefile -Message "ERROR: Failed to download RSS for $($site.Name) : $($_.ToString())"
			}
		}
		$syncHash.RSSElements = $syncHash.RSSElements | Sort-Object -Property Date,Name -Descending
		#Tracefile -Message "DEBUG: END: $(Get-Date)"
	}
	
	function DownloadTorrents {
		foreach ($oldfile in $(Get-Item -Path "$($env:TEMP)\$($syncHash.AppName)_*")) {
			if ($(Get-Date).ToUniversalTime().Ticks - $oldfile.CreationTimeUtc.Ticks -gt $(10000000 * 60 * 60 * 24)) {
				Remove-Item -Path $($oldfile.FullName) -Force -Recurse -ErrorAction SilentlyContinue
			}
		}
		
		$count = 0
		foreach ($Downloaded in $syncHash.ToDownload) {
			try {
				$torrentfile = "$($env:TEMP)\$($syncHash.AppName)_$(Get-Date -Format 'yyyyMMdd_hhss_ff').torrent"
				Tracefile -Type Info -Message "Downloading torrentfile for `"$($Downloaded.Title)`" from $($Downloaded.Site)"
				$null = Invoke-WebRequest -Uri $Downloaded.Link -OutFile $torrentfile -TimeoutSec 5 -ErrorAction Stop
				$null = Invoke-Item -Path $torrentfile -Confirm:$false
			}
			catch {
				Tracefile -Type Error -Message "FAILED: Downloading/opening torrentfile for `"$($Downloaded.Title)`""
				$syncHash.ToDownload = $syncHash.Download | Where-Object -Property Title -NE $Downloaded.title
			}
		}
	}
	
	function ReadBookmarks {
		#Tracefile -Message "DEBUG: Start: $(Get-Date)"
		$bookmarks = (Get-ChildItem -Path "$($syncHash.RegBase)\Bookmarks" -ErrorAction Stop).PSChildName
		[array]$syncHash.Bookmarks = @()
		foreach ($bookmark in $bookmarks) {
			$Episodes = Get-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$bookmark" -ErrorAction Stop
			[array]$arrEpisodes = @()
			[array]$arrRepacks = @()
			[array]$arrDates = @()
			foreach ($prop in $Episodes.PSObject.Properties) {
				if ($prop.Name.StartsWith('Episode:')) {
					$arrEpisodes += [int]($prop.Name -replace 'Episode:')
					if (($prop.Value -split '\|')[-1].Length -gt 1) {
						$arrRepacks += [int]($prop.Name -replace 'Episode:')
					}
					if (($prop.Value -split ':')[0].Length -gt 1) {
						$arrDates += "$([int]($prop.Name -replace 'Episode'))$(($prop.Value -split '\|')[0])"
					}
				}
			}
			$ReleaseGroups = Get-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$bookmark\ReleaseGroups" -ErrorAction Stop
			[array]$arrReleaseGroups = @()
			foreach ($prop in $ReleaseGroups.PSObject.Properties) {
				if (-not ($prop.Name.StartsWith('PS'))) {
					$arrReleaseGroups += $prop.Name
				}
			}
			$Resolutions = Get-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$bookmark\Resolutions" -ErrorAction Stop
			[array]$arrResolutions = @()
			foreach ($prop in $Resolutions.PSObject.Properties) {
				if (-not ($prop.Name.StartsWith('PS'))) {
					$arrResolutions += $prop.Name
				}
			}
			$Sources = Get-ItemProperty -Path "$($syncHash.RegBase)\Bookmarks\$bookmark\Sources" -ErrorAction Stop
			[array]$arrSources = @()
			foreach ($prop in $Sources.PSObject.Properties) {
				if (-not ($prop.Name.StartsWith('PS'))) {
					$arrSources += $prop.Name
				}
			}
			
			$objBookmark = [PSCustomObject]@{
				Name		  = $bookmark
				Episodes	  = $arrEpisodes
				ReleaseGroups = $arrReleaseGroups
				Resolutions   = $arrResolutions
				Sources	      = $arrSources
				Repacks	      = $arrRepacks
				Dates		  = $arrDates
			}
			$syncHash.Bookmarks += $objBookmark
		}
		#Tracefile -Message "DEBUG: END: $(Get-Date)"
	}
	
	#endregion
	
	if ($syncHash.AsyncCommand -eq "UpdateAll") {
		$syncHash.ShowLoading = $true
		UpdateRSS
		ReadBookmarks
		MatchRSSToBookmarks
		SanitizeMatchedRSSHits
		DownloadTorrents
		UpdateRegistryAfterDownload
		$syncHash.UpdateBookmarksNow = $true
		if ($syncHash.UpdateTable -eq $true) {
			Start-Sleep -Milliseconds 500
			$syncHash.AsyncCommand = "UpdateTable"
			$syncHash.UpdateTable = $false
		}
		$syncHash.ShowLoading = $false
	}
	if ($syncHash.AsyncCommand -eq "ReadBookmarks") {
		ReadBookmarks
		$syncHash.UpdateBookmarksNow = $true
	}
	$syncHash.TimerWait = $false
}
#endregion

#region form events
$formRSSTVDownloader_Load = {
	Tracefile -Message "App starting" -Type Warning
	Set-ControlTheme $formRSSTVDownloader -Theme Dark
	$labelLoadingPleaseWait.Visible = $true
	HideInfoBox
	HideRSSKey
	UpdateTVSources
	UpdateTVResolutions
	CreateSitesMenu
	$syncHash.AsyncCommand = "ReadBookmarks"
#	StartAsync -RemoteHashName 'syncHash' -AsyncScript $asyncScript
#	Start-Sleep -Milliseconds 500
	$syncHash.AsyncCommand = "UpdateAll"
	StartAsync -RemoteHashName 'syncHash' -AsyncScript $asyncScript
}

$formRSSTVDownloader_Shown = {
	try {
		$syncHash.UpdateTable = $true
		$syncHash.AsyncCommand = "UpdateTable"
		StartAsync -RemoteHashName 'syncHash' -AsyncScript $asyncScript
	}
	catch {
		ShowInfoBox
		$syncHash.AsyncCommand = "None"
		& $rSSKeyToolStripMenuItem_Click
	}
}
#endregion

#region look and feel events
$darkToolStripMenuItem_Click={
	#TODO: Place custom script here
	[string]$syncHash.ThemeColor = "Dark"
	Set-ControlTheme -Control $formRSSTVDownloader -Theme $syncHash.ThemeColor
}

$lightToolStripMenuItem_Click={
	[string]$syncHash.ThemeColor = "Light"
	Set-ControlTheme -Control $formRSSTVDownloader -Theme $syncHash.ThemeColor
}
#endregion

#region Button events
$buttonRefresh_Click= {
	$syncHash.AsyncCommand -eq "UpdateTable"
	StartAsync -RemoteHashName 'syncHash' -AsyncScript $asyncScript
	$syncHash.UpdateTable = $true
}

$buttonSave_Click = {
	if ($labelInput.Tag -eq "RSSKey") {
		HideInfoBox
		$null = New-ItemProperty -Path "$($syncHash.RegBase)\Sites\$($syncHash.CurrentSite)" -Name "RSSKey" -PropertyType String -Value $textboxInput.Text -Force -ErrorAction Stop
		#$rssurl = (Get-ItemProperty -Path "$($syncHash.RegBase)\Sites\$($syncHash.CurrentSite)" -Name "URL"  -ErrorAction Stop) -replace '<RSSKEY>', $($syncHash.CurrentSite)
		UpdateRSSIntervals
		$syncHash.AsyncCommand -eq "UpdateAll"
		StartAsync -RemoteHashName 'syncHash' -AsyncScript $asyncScript
	}
	elseif ($labelInput.Tag -eq "Resolution") {
		$syncHash.TVResolution += $textboxInput.Text.Trim()
		UpdateTVResolutions
	}
	elseif ($labelEpisode.Tag -eq "Source") {
		$syncHash.TVSources += $textboxInput.Text.Trim()
		UpdateTVSources
	}
	$syncHash.AsyncCommand = "UpdateAll"
	ShowTable
}

$buttonCancel_Click = {
	HideInfoBox
	ShowTable
}

$buttonBookmark_Click = {
	AddBookmark
	#$syncHash.UpdateBookmarksNow -eq $true
	$syncHash.AsyncCommand = "ReadBookmarks"
}
#endregion

#region table events
$datagridview1_CellClick=[System.Windows.Forms.DataGridViewCellEventHandler]{
	SelectRow
}
#endregion

#region Toolstrip events
$rSSKeyToolStripMenuItem_Click={
	HideTable
	$labelInput.Text = "RSS Key"
	$labelInput.Tag = "RSSKey"
	$labelInput.Visible = $true
	$textboxInput.Visible = $true
	$textboxInput.Text = ""
	$buttonSave.Visible = $true
	$buttonCancel.Visible = $true
	$textboxInput.Focus()
}

$ToolStripMenuItem1minute_Click = {
	UncheckRSSIntervals
	$ToolStripMenuItemRSS1minute.Checked = $true
	$syncHash.RSSInterval = 1 * 60
	UpdateRSSIntervals
}

$ToolStripMenuItem2minutes_Click={
	UncheckRSSIntervals
	$ToolStripMenuItemRSS2minutes.Checked = $true
	$syncHash.RSSInterval = 2 * 60
	UpdateRSSIntervals
}

$ToolStripMenuItem5minutes_Click={
	UncheckRSSIntervals
	$ToolStripMenuItemRSS5minutes.Checked = $true
	$syncHash.RSSInterval = 5 * 60
	UpdateRSSIntervals
}

$ToolStripMenuItem10minutes_Click={
	UncheckRSSIntervals
	$ToolStripMenuItemRSS10minutes.Checked = $true
	$syncHash.RSSInterval = 10 * 60
	UpdateRSSIntervals
}

$ToolStripMenuItem30minutes_Click={
	UncheckRSSIntervals
	$ToolStripMenuItemRSS30minutes.Checked = $true
	$syncHash.RSSInterval = 30 * 60
	UpdateRSSIntervals
}

$ToolStripMenuItem1hour_Click={
	UncheckRSSIntervals
	$ToolStripMenuItemRSS1hour.Checked = $true
	$syncHash.RSSInterval = 1 * 60 * 60
	UpdateRSSIntervals
}

$ToolStripMenuItem2hours_Click={
	UncheckRSSIntervals
	$ToolStripMenuItemRSS2hours.Checked = $true
	$syncHash.RSSInterval = 2 * 60 * 60
	UpdateRSSIntervals
}

$ToolStripMenuItemPause_Click={
	UncheckRSSIntervals
	$ToolStripMenuItemRSSPause.Checked = $true
	$syncHash.RSSInterval = 0
	UpdateRSSIntervals
}

$previousOnlyToolStripMenuItem_Click = {
	UncheckBacklog
	$syncHash.Backlog = "0:1"
	$previousOnlyToolStripMenuItem.Checked = $true
	UpdateBacklog
}

$twoPreviousToolStripMenuItem_Click = {
	UncheckBacklog
	$syncHash.Backlog = "0:2"
	$twoPreviousToolStripMenuItem.Checked = $true
	UpdateBacklog
}

$fivePreviousToolStripMenuItem_Click = {
	UncheckBacklog
	$syncHash.Backlog = "0:5"
	$fivePreviousToolStripMenuItem.Checked = $true
	UpdateBacklog
}

$anyInSeasonToolStripMenuItem_Click = {
	UncheckBacklog
	$syncHash.Backlog = "0:999"
	$anyInSeasonToolStripMenuItem.Checked = $true
	UpdateBacklog
}

$allPreviousToolStripMenuItem_Click = {
	UncheckBacklog
	$syncHash.Backlog = "999:999"
	$allPreviousToolStripMenuItem.Checked = $true
	UpdateBacklog
}

$noneToolStripMenuItem_Click = {
	UncheckBacklog
	$syncHash.Backlog = "0:0"
	$noneToolStripMenuItem.Checked = $true
	UpdateBacklog
}

$addSourceToolStripMenuItem_Click= {
	HideTable
	$labelInput.Text = "Source"
	$labelInput.Tag = "Source"
	$labelInput.Visible = $true
	$textboxInput.Visible = $true
	$textboxInput.Text = ""
	$buttonSave.Visible = $true
	$buttonCancel.Visible = $true
	$textboxInput.Focus()
}

$addResolutionToolStripMenuItem_Click={
	HideTable
	$labelInput.Text = "Resolution"
	$labelInput.Tag = "Resolution"
	$labelInput.Visible = $true
	$textboxInput.Visible = $true
	$textboxInput.Text = ""
	$buttonSave.Visible = $true
	$buttonCancel.Visible = $true
	$textboxInput.Focus()
}

$autodownloadRepackproperToolStripMenuItem_Click = {
	if ($autodownloadRepackproperToolStripMenuItem.Checked) {
		$syncHash.DownloadRepack = $false
		$autodownloadRepackproperToolStripMenuItem.Checked = $false
	}
	else {
		$syncHash.DownloadRepack = $true
		$autodownloadRepackproperToolStripMenuItem.Checked = $true
	}
}
#endregion

#region Timer events
$timer1_Tick = {
	if ($syncHash.ShowLoading -eq $true) {
		$labelLoadingPleaseWait.Visible = $true
	}
	else {
		$labelLoadingPleaseWait.Visible = $false
	}
	$maxwait = 10000000 * 60
	$now = (Get-Date).ToUniversalTime().Ticks
	if ($syncHash.AsyncCommand -eq "None") {
		return
	}
	if ($syncHash.UpdateBookmarksNow -eq $true) {
		$labelLoadingPleaseWait.Visible = $true
		UpdateBookmarksMenu
		$labelLoadingPleaseWait.Visible = $false
		$syncHash.UpdateBookmarksNow = $false
	}
	if ($syncHash.AsyncCommand -eq "UpdateTable") {
		$labelLoadingPleaseWait.Visible = $true
		ShowTable
		UpdateTable
		$labelLoadingPleaseWait.Visible = $false
		$syncHash.AsyncCommand = "UpdateAll"
		return
	}
	if ($syncHash.AsyncCommand -eq "ReadBookmarks") {
		StartAsync -RemoteHashName 'syncHash' -AsyncScript $asyncScript
		$syncHash.AsyncCommand = "UpdateAll"
		return
	}
	if ($syncHash.TimerWait -eq $true -and ($now - $syncHash.TimerStart) -lt $maxwait) {
		return
	}
	if (($now - $syncHash.TimerStart) -lt ($syncHash.RSSInterval * 10000000)) {
		return
	}
	StartAsync -RemoteHashName 'syncHash' -AsyncScript $asyncScript
}
#endregion

#region MAIN VARIABLES
[string]$global:MyNameIs = "RSSTVDownloader"

$global:syncHash = [hashtable]::Synchronized(@{
	})

[string]$syncHash.AppName = $global:MyNameIs
[string]$syncHash.RegBase = "HKCU:\Software\$($syncHash.AppName)"

[array]$syncHash.sitesInfo = @()
[array]$syncHash.categoryTV = @("Episodes", "Episodes HD", "Foreign", "Anime")
[array]$syncHash.HideTableColumnNames = @("Link", "Repack", "Season", "Episode","Category", "LinkName")

[array]$syncHash.TVSource = @("WEB", "WEBRIP", "WEB-DL", "WEBDL", "HDTV", "AHDTV", "HEVC", "AV1 10BIT", "VHS")
[hashtable]$syncHash.TVSourceGroupsDefault = @{
	"WEB" = "WEB", "WEBRIP", "WEB-DL", "WEBDL"
	"HDTV" = "HDTV", "AHDTV"
}
[array]$syncHash.TVResolution = @("480p", "576p", "720p", "720i", "1080p", "1080i", "2160p", "HDR 2160p", "DV 2160p")
[array]$syncHash.TVRepack = @("Repack", "RealRepack", "Real Repack", "Proper", "RealProper", "Real Proper", "TrueProper", "True Proper")

[string]$syncHash.regexStringTVEpisodes = '[sS]\ ?[0-9]{1,3}\ ?[eE]\ ?[0-9]{1,3}'
[string]$syncHash.regexStringTVName = '^(?<name>.*?)(?=[\ |\.]*' + $syncHash.regexStringTVEpisodes + ')'

[string]$syncHash.regexWordDelimeter = '[\ \._\(\)\[\]]+'
[string]$syncHash.regexStringTVSource = createWordRegex -elements $syncHash.TVSource
[string]$syncHash.regexStringTVResolution = createWordRegex -elements $syncHash.TVResolution
[string]$syncHash.regexStringTVRepack = createWordRegex -elements $syncHash.TVRepack

[regex]$syncHash.regexTVEpisodes = '(?<episode>' + $syncHash.regexStringTVEpisodes + ')'
[regex]$syncHash.regexTVSource = '(?<source>' + $syncHash.regexStringTVSource + ')'
[regex]$syncHash.regexTVResolution = '(?<resolution>' + $syncHash.regexStringTVResolution + ')'
[regex]$syncHash.regexTVName = $syncHash.regexStringTVName
[regex]$syncHash.regexTVGroup = '[\-\ ](?<group>[a-zA-Z0-9\.]*)$'
[regex]$syncHash.regexTVEpisodesGroup = '[sS]\ ?(?<season>[0-9]{1,3})\ ?[eE]\ ?(?<episode>[0-9]{1,3})'
[regex]$syncHash.regexTVRepack = '(?<repack>' + $syncHash.regexStringTVRepack + ')'

[regex]$syncHash.RSSregex = '(\<[a-zA-Z]*\>)(\<?[[\!]?\[CDATA\[]?)?(?<data>[a-zA-Z0-9\.\-\+\#\%\&\ \:\/\(\)]*)(.*)'

[string]$syncHash.ThemeColor = "dark"

[array]$syncHash.RSSElements = @()

[array]$syncHash.Bookmarks = @()
[array]$syncHash.ToDownload = @()
[array]$syncHash.MatchedRSSHits = @()

[bool]$syncHash.UpdateBookmarksNow = $false
[bool]$syncHash.TimerWait = $true
[long]$syncHash.TimerStart = (Get-Date).ToUniversalTime().Ticks
[string]$syncHash.AsyncCommand = "UpdateAll"

[int]$syncHash.RSSIntervalDefault = 120
[string]$syncHash.BacklogDefault = "0:999"
[int]$syncHash.RepackHoursDefault = 6
[bool]$syncHash.DownloadRepack = $true

$syncHash.FormWindowState = [System.Windows.Forms.FormWindowState]::Normal

#endregion

#region Registry Config
if (-not (Test-Path -Path "$($syncHash.RegBase)")) {
	$null = New-Item -Path "$($syncHash.RegBase)" -ItemType Directory -Force -ErrorAction Stop
}
if (-not (Test-Path -Path "$($syncHash.RegBase)\Bookmarks")) {
	$null = New-Item -Path "$($syncHash.RegBase)\Bookmarks" -ItemType Directory -Force -ErrorAction Stop
}
if (-not (Test-Path -Path "$($syncHash.RegBase)\Sites")) {
	$null = New-Item -Path "$($syncHash.RegBase)\Sites" -ItemType Directory -Force -ErrorAction Stop
}

try {
		$syncHash.RSSInterval = Get-ItemPropertyValue -Path $syncHash.RegBase -Name "RSSInterval" -ErrorAction Stop
	}
catch {
	$syncHash.RSSInterval = $syncHash.RSSIntervalDefault
	$null = New-ItemProperty -Path $syncHash.RegBase -Name "RSSInterval" -Value $syncHash.RSSInterval -PropertyType DWord -Force -ErrorAction Stop
}
switch ($syncHash.RSSInterval) {
	60 {
		$timer1.Interval = 1 * 60 * 1000
		$ToolStripMenuItemRSS1minute.Checked = $true
	}
	120 {
		$timer1.Interval = 2 * 60 * 1000
		$ToolStripMenuItemRSS2minutes.Checked = $true
	}
	300 {
		$timer1.Interval = 5 * 60 * 1000
		$ToolStripMenuItemRSS5minutes.Checked = $true
	}
	600 {
		$timer1.Interval = 10 * 60 * 1000
		$ToolStripMenuItemRSS10minutes.Checked = $true
	}
	1800 {
		$timer1.Interval = 30 * 60 * 1000
		$ToolStripMenuItemRSS30minutes.Checked = $true
	}
	3600 {
		$timer1.Interval = 60 * 60 * 1000
		$ToolStripMenuItemRSS1hour.Checked = $true
	}
	7200 {
		$timer1.Interval = 120 * 60 * 1000
		$ToolStripMenuItemRSS2hours.Checked = $true
	}
	default {
		$timer1.Enabled = $false
		$ToolStripMenuItemRSSPause.Checked = $true
	}
}

try {
	$syncHash.Backlog = Get-ItemPropertyValue -Path $syncHash.RegBase -Name "BacklogInterval" -ErrorAction Stop
}
catch {
	$syncHash.Backlog = $syncHash.BacklogDefault
	$null = New-ItemProperty -Path $syncHash.RegBase -Name "BacklogInterval" -Value $syncHash.Backlog -PropertyType String -Force -ErrorAction Stop
}
switch ($syncHash.Backlog) {
	"0:1" {
		$previousOnlyToolStripMenuItem.Checked = $true
	}
	"0:2" {
		$twoPreviousToolStripMenuItem.Checked = $true
	}
	"0:5" {
		$fivePreviousToolStripMenuItem.Checked = $true
	}
	"0:999" {
		$anyInSeasonToolStripMenuItem.Checked = $true
	}
	default {
		$allPreviousToolStripMenuItem.Checked = $true
	}
}

try {
	$syncHash.RepackHours = Get-ItemPropertyValue -Path $syncHash.RegBase -Name "RepackHours" -ErrorAction Stop
}
catch {
	$syncHash.RepackHours = $syncHash.RepackHoursDefault
	$null = New-ItemProperty -Path $syncHash.RegBase -Name "RepackHours" -Value $syncHash.RepackHours -PropertyType DWord -Force -ErrorAction Stop
}

try {
	$strings = Get-ItemPropertyValue -Path $syncHash.RegBase -Name "TVSourceGroups" -ErrorAction Stop
	$hash = @{ }
	foreach ($hashstring in $($strings -split ',')) {
		$hashkey = ($hashstring -split ':')[0] 
		$arr = @()
		foreach ($arraystring in $hashstring -split '\|') {
			$arr += $arraystring
		}
		$hash.Add($hashkey, $arr)
	}
	$syncHash.TVSourceGroups = $hash
	
	Write-Host $hash
}
catch {
	$syncHash.TVSourceGroups = $syncHash.TVSourceGroupsDefault
	$strings = @()
	foreach ($key in $syncHash.TVSourceGroups.Keys) {
		$string = "$($key):"
		$substrings = @()
		foreach ($val in $syncHash.TVSourceGroups.$key) {
			$substrings += "$($val)"
		}
		$strings += $substrings -join '|'
	}
	$null = New-ItemProperty -Path $syncHash.RegBase -Name "TVSourceGroups" -Value $($strings -join ',') -PropertyType String -Force -ErrorAction Stop
}
#endregion

#region Default sites info
$arraySites = @()

#TorrentLeech
$arraySites += [PSCustomObject]@{
	Name = "TorrentLeech"
	URL  = [String]"https://rss24h.torrentleech.org/<RSSKEY>"
	RSSKey = [string]""
	CategoryKey = [string]"Category"
	Categories = [array]@("Episodes", "Episodes HD", "Foreign", "Anime")
	Enabled = [int]0
}

#NORBits
$arraySites += [PSCustomObject]@{
	Name = "NORBits"
	URL  = [String]"https://norbits.net/rss.php?feed=dl&passkey=<RSSKEY>&format=bb&cats=2,0,0,0"
	RSSKey = [string]""
	CategoryKey = [string]""
	Categories = [array]@()
	Enabled = [int]0
}

#BLUTOPIA
$arraySites += [PSCustomObject]@{
	Name = "BLUTopia"
	URL  = [String]"https://blutopia.cc/rss/549.<RSSKEY>"
	RSSKey = [string]""
	CategoryKey = [string]""
	Categories = [array]@()
	Enabled = [int]0
}

foreach ($site in $arraySites) {
	if (-not (Test-Path -Path "$($syncHash.RegBase)\Sites\$($site.Name)")) {
		$null = New-Item -Path "$($syncHash.RegBase)\Sites\$($site.Name)" -ItemType Directory -Force -ErrorAction Stop
		$null = New-ItemProperty -Path "$($syncHash.RegBase)\Sites\$($site.Name)" -Name URL -PropertyType String -Value $site.URL -Force -ErrorAction Stop
		$null = New-ItemProperty -Path "$($syncHash.RegBase)\Sites\$($site.Name)" -Name RSSKey -PropertyType String -Value $site.RSSKey -Force -ErrorAction Stop
		$null = New-ItemProperty -Path "$($syncHash.RegBase)\Sites\$($site.Name)" -Name CategoryKey -PropertyType String -Value $site.CategoryKey -Force -ErrorAction Stop
		$null = New-ItemProperty -Path "$($syncHash.RegBase)\Sites\$($site.Name)" -Name Categories -PropertyType String -Value $($site.Categories -join ',') -Force -ErrorAction Stop
		$null = New-ItemProperty -Path "$($syncHash.RegBase)\Sites\$($site.Name)" -Name Enabled -PropertyType DWord -Value $site.Enabled -Force -ErrorAction Stop
	}
}
#endregion

#region Disabled stuff
$formRSSTVDownloader_Resize={
#	if ($formRSSTVDownloader.WindowState -eq 'Minimized') {
#		Write-Host "Minimized"
#		#$formRSSTVDownloader.Hide()
#		$notifyicon1.Visible = $true
#		$notifyicon1.ShowBalloonTip(3000, "App minimized", "The application has been minimized to the system tray.", [System.Windows.Forms.ToolTipIcon]::Info)
#	}
#	else {
#		Write-Host "Resized"
#		$syncHash.FormWindowState = $formRSSTVDownloader.WindowState
#	}
}

$formRSSTVDownloader.add_FormClosing($formRSSTVDownloader_Closing)

$notifyicon1_Click={
	$formRSSTVDownloader.Show()
	$formRSSTVDownloader.WindowState = $syncHash.FormWindowState
	$notifyicon1.Visible = $false
	$formRSSTVDownloader.Activate()
}

$formRSSTVDownloader_FormClosing=[System.Windows.Forms.FormClosingEventHandler]{
	Tracefile -Message "App closing" -Type Warning
	
#	Write-Host "Closing"
#	$notifyicon1.Dispose()
}
#endregion]]></Code>
  <TV>0</TV>
  <Mode>1</Mode>
  <Assemblies />
</File>